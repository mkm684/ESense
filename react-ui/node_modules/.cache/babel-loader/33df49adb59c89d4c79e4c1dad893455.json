{"ast":null,"code":"/*!\n * chartjs-plugin-streaming v1.8.0\n * https://nagix.github.io/chartjs-plugin-streaming\n * (c) 2019 Akihiko Kusanagi\n * Released under the MIT license\n */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('chart.js'), require('moment')) : typeof define === 'function' && define.amd ? define(['chart.js', 'moment'], factory) : (global = global || self, global.ChartStreaming = factory(global.Chart, global.moment));\n})(this, function (Chart, moment) {\n  'use strict';\n\n  Chart = Chart && Chart.hasOwnProperty('default') ? Chart['default'] : Chart;\n  moment = moment && moment.hasOwnProperty('default') ? moment['default'] : moment;\n  var helpers = Chart.helpers;\n\n  var cancelAnimFrame = function () {\n    if (typeof window !== 'undefined') {\n      return window.cancelAnimationFrame || window.webkitCancelAnimationFrame || window.mozCancelAnimationFrame || window.oCancelAnimationFrame || window.msCancelAnimationFrame || function (id) {\n        return window.clearTimeout(id);\n      };\n    }\n  }();\n\n  var StreamingHelper = {\n    startFrameRefreshTimer: function startFrameRefreshTimer(context, func) {\n      if (!context.frameRequestID) {\n        var frameRefresh = function frameRefresh() {\n          func();\n          context.frameRequestID = helpers.requestAnimFrame.call(window, frameRefresh);\n        };\n\n        context.frameRequestID = helpers.requestAnimFrame.call(window, frameRefresh);\n      }\n    },\n    stopFrameRefreshTimer: function stopFrameRefreshTimer(context) {\n      var frameRequestID = context.frameRequestID;\n\n      if (frameRequestID) {\n        cancelAnimFrame.call(window, frameRequestID);\n        delete context.frameRequestID;\n      }\n    }\n  };\n  var helpers$1 = Chart.helpers;\n  var canvasHelpers = helpers$1.canvas;\n  var scaleService = Chart.scaleService;\n  var TimeScale = scaleService.getScaleConstructor('time');\n\n  scaleService.getScaleConstructor = function (type) {\n    // For backwards compatibility\n    if (type === 'time') {\n      type = 'realtime';\n    }\n\n    return this.constructors.hasOwnProperty(type) ? this.constructors[type] : undefined;\n  }; // For Chart.js 2.7.x backward compatibility\n\n\n  var defaultAdapter = {\n    // Ported from Chart.js 2.8.0-rc.1 35273ee\n    parse: function parse(value, format) {\n      if (typeof value === 'string' && typeof format === 'string') {\n        value = moment(value, format);\n      } else if (!(value instanceof moment)) {\n        value = moment(value);\n      }\n\n      return value.isValid() ? value.valueOf() : null;\n    }\n  }; // Ported from Chart.js 2.8.0-rc.1 35273ee. Modified for Chart.js 2.7.x backward compatibility.\n\n  function toTimestamp(scale, input) {\n    var adapter = scale._adapter || defaultAdapter;\n    var options = scale.options.time;\n    var parser = options.parser;\n    var format = parser || options.format;\n    var value = input;\n\n    if (typeof parser === 'function') {\n      value = parser(value);\n    } // Only parse if its not a timestamp already\n\n\n    if (typeof value !== 'number' && !(value instanceof Number) || !isFinite(value)) {\n      value = typeof format === 'string' ? adapter.parse(value, format) : adapter.parse(value);\n    }\n\n    if (value !== null) {\n      return +value;\n    } // Labels are in an incompatible format and no `parser` has been provided.\n    // The user might still use the deprecated `format` option for parsing.\n\n\n    if (!parser && typeof format === 'function') {\n      value = format(input); // `format` could return something else than a timestamp, if so, parse it\n\n      if (typeof value !== 'number' && !(value instanceof Number) || !isFinite(value)) {\n        value = adapter.parse(value);\n      }\n    }\n\n    return value;\n  } // Ported from Chart.js 2.8.0-rc.1 35273ee\n\n\n  function parse(scale, input) {\n    if (helpers$1.isNullOrUndef(input)) {\n      return null;\n    }\n\n    var options = scale.options.time;\n    var value = toTimestamp(scale, scale.getRightValue(input));\n\n    if (value === null) {\n      return value;\n    }\n\n    if (options.round) {\n      value = +scale._adapter.startOf(value, options.round);\n    }\n\n    return value;\n  }\n\n  function resolveOption(scale, key) {\n    var realtimeOpts = scale.options.realtime;\n    var streamingOpts = scale.chart.options.plugins.streaming;\n    return helpers$1.valueOrDefault(realtimeOpts[key], streamingOpts[key]);\n  }\n\n  var datasetPropertyKeys = ['pointBackgroundColor', 'pointBorderColor', 'pointBorderWidth', 'pointRadius', 'pointRotation', 'pointStyle', 'pointHitRadius', 'pointHoverBackgroundColor', 'pointHoverBorderColor', 'pointHoverBorderWidth', 'pointHoverRadius', 'backgroundColor', 'borderColor', 'borderSkipped', 'borderWidth', 'hoverBackgroundColor', 'hoverBorderColor', 'hoverBorderWidth', 'hoverRadius', 'hitRadius', 'radius', 'rotation'];\n\n  function refreshData(scale) {\n    var chart = scale.chart;\n    var id = scale.id;\n    var duration = resolveOption(scale, 'duration');\n    var delay = resolveOption(scale, 'delay');\n    var ttl = resolveOption(scale, 'ttl');\n    var pause = resolveOption(scale, 'pause');\n    var onRefresh = resolveOption(scale, 'onRefresh');\n    var max = scale.max;\n    var min = Date.now() - (isNaN(ttl) ? duration + delay : ttl);\n    var meta, data, length, i, start, count, removalRange;\n\n    if (onRefresh) {\n      onRefresh(chart);\n    } // Remove old data\n\n\n    chart.data.datasets.forEach(function (dataset, datasetIndex) {\n      meta = chart.getDatasetMeta(datasetIndex);\n\n      if (id === meta.xAxisID || id === meta.yAxisID) {\n        data = dataset.data;\n        length = data.length;\n\n        if (pause) {\n          // If the scale is paused, preserve the visible data points\n          for (i = 0; i < length; ++i) {\n            if (!(scale._getTimeForIndex(i, datasetIndex) < max)) {\n              break;\n            }\n          }\n\n          start = i + 2;\n        } else {\n          start = 0;\n        }\n\n        for (i = start; i < length; ++i) {\n          if (!(scale._getTimeForIndex(i, datasetIndex) <= min)) {\n            break;\n          }\n        }\n\n        count = i - start;\n\n        if (isNaN(ttl)) {\n          // Keep the last two data points outside the range not to affect the existing bezier curve\n          count = Math.max(count - 2, 0);\n        }\n\n        data.splice(start, count);\n        datasetPropertyKeys.forEach(function (key) {\n          if (dataset.hasOwnProperty(key) && helpers$1.isArray(dataset[key])) {\n            dataset[key].splice(start, count);\n          }\n        });\n        helpers$1.each(dataset.datalabels, function (value) {\n          if (helpers$1.isArray(value)) {\n            value.splice(start, count);\n          }\n        });\n\n        if (typeof data[0] !== 'object') {\n          removalRange = {\n            start: start,\n            count: count\n          };\n        }\n      }\n    });\n\n    if (removalRange) {\n      chart.data.labels.splice(removalRange.start, removalRange.count);\n    }\n\n    chart.update({\n      preservation: true\n    });\n  }\n\n  function stopDataRefreshTimer(scale) {\n    var realtime = scale.realtime;\n    var refreshTimerID = realtime.refreshTimerID;\n\n    if (refreshTimerID) {\n      clearInterval(refreshTimerID);\n      delete realtime.refreshTimerID;\n      delete realtime.refreshInterval;\n    }\n  }\n\n  function startDataRefreshTimer(scale) {\n    var realtime = scale.realtime;\n    var interval = resolveOption(scale, 'refresh');\n    realtime.refreshTimerID = setInterval(function () {\n      var newInterval = resolveOption(scale, 'refresh');\n      refreshData(scale);\n\n      if (realtime.refreshInterval !== newInterval && !isNaN(newInterval)) {\n        stopDataRefreshTimer(scale);\n        startDataRefreshTimer(scale);\n      }\n    }, interval);\n    realtime.refreshInterval = interval;\n  }\n\n  var transitionKeys = {\n    x: {\n      data: ['x', 'controlPointPreviousX', 'controlPointNextX'],\n      dataset: ['x'],\n      tooltip: ['x', 'caretX']\n    },\n    y: {\n      data: ['y', 'controlPointPreviousY', 'controlPointNextY'],\n      dataset: ['y'],\n      tooltip: ['y', 'caretY']\n    }\n  };\n\n  function transition(element, keys, translate) {\n    var start = element._start || {};\n    var view = element._view || {};\n    var model = element._model || {};\n    var i, ilen;\n\n    for (i = 0, ilen = keys.length; i < ilen; ++i) {\n      var key = keys[i];\n\n      if (start.hasOwnProperty(key)) {\n        start[key] -= translate;\n      }\n\n      if (view.hasOwnProperty(key) && view !== start) {\n        view[key] -= translate;\n      }\n\n      if (model.hasOwnProperty(key) && model !== view) {\n        model[key] -= translate;\n      }\n    }\n  }\n\n  function scroll(scale) {\n    var chart = scale.chart;\n    var realtime = scale.realtime;\n    var duration = resolveOption(scale, 'duration');\n    var delay = resolveOption(scale, 'delay');\n    var id = scale.id;\n    var tooltip = chart.tooltip;\n    var activeTooltip = tooltip._active;\n    var now = Date.now();\n    var length, keys, offset, meta, elements, i, ilen;\n\n    if (scale.isHorizontal()) {\n      length = scale.width;\n      keys = transitionKeys.x;\n    } else {\n      length = scale.height;\n      keys = transitionKeys.y;\n    }\n\n    offset = length * (now - realtime.head) / duration;\n\n    if (scale.options.ticks.reverse) {\n      offset = -offset;\n    } // Shift all the elements leftward or upward\n\n\n    helpers$1.each(chart.data.datasets, function (dataset, datasetIndex) {\n      meta = chart.getDatasetMeta(datasetIndex);\n\n      if (id === meta.xAxisID || id === meta.yAxisID) {\n        elements = meta.data || [];\n\n        for (i = 0, ilen = elements.length; i < ilen; ++i) {\n          transition(elements[i], keys.data, offset);\n        }\n\n        if (meta.dataset) {\n          transition(meta.dataset, keys.dataset, offset);\n        }\n      }\n    }); // Shift tooltip leftward or upward\n\n    if (activeTooltip && activeTooltip[0]) {\n      meta = chart.getDatasetMeta(activeTooltip[0]._datasetIndex);\n\n      if (id === meta.xAxisID || id === meta.yAxisID) {\n        transition(tooltip, keys.tooltip, offset);\n      }\n    }\n\n    scale.max = scale._table[1].time = now - delay;\n    scale.min = scale._table[0].time = scale.max - duration;\n    realtime.head = now;\n  }\n\n  var defaultConfig = {\n    position: 'bottom',\n    distribution: 'linear',\n    bounds: 'data',\n    adapters: {},\n    time: {\n      parser: false,\n      // false == a pattern string from http://momentjs.com/docs/#/parsing/string-format/ or a custom callback that converts its argument to a moment\n      format: false,\n      // DEPRECATED false == date objects, moment object, callback or a pattern string from http://momentjs.com/docs/#/parsing/string-format/\n      unit: false,\n      // false == automatic or override with week, month, year, etc.\n      round: false,\n      // none, or override with week, month, year, etc.\n      displayFormat: false,\n      // DEPRECATED\n      isoWeekday: false,\n      // override week start day - see http://momentjs.com/docs/#/get-set/iso-weekday/\n      minUnit: 'millisecond',\n      // defaults to unit's corresponding unitFormat below or override using pattern string from http://momentjs.com/docs/#/displaying/format/\n      displayFormats: {\n        millisecond: 'h:mm:ss.SSS a',\n        second: 'h:mm:ss a',\n        minute: 'h:mm a',\n        hour: 'hA',\n        day: 'MMM D',\n        week: 'll',\n        month: 'MMM YYYY',\n        quarter: '[Q]Q - YYYY',\n        year: 'YYYY'\n      }\n    },\n    realtime: {},\n    ticks: {\n      autoSkip: false,\n      source: 'auto',\n      major: {\n        enabled: true\n      }\n    }\n  };\n  var RealTimeScale = TimeScale.extend({\n    initialize: function initialize() {\n      var me = this;\n      TimeScale.prototype.initialize.apply(me, arguments); // For backwards compatibility\n\n      if (me.options.type === 'time' && !me.chart.options.plugins.streaming) {\n        return;\n      }\n\n      me.realtime = me.realtime || {};\n      startDataRefreshTimer(me);\n    },\n    update: function update() {\n      var me = this;\n      var realtime = me.realtime; // For backwards compatibility\n\n      if (me.options.type === 'time' && !me.chart.options.plugins.streaming) {\n        return TimeScale.prototype.update.apply(me, arguments);\n      }\n\n      if (resolveOption(me, 'pause')) {\n        StreamingHelper.stopFrameRefreshTimer(realtime);\n      } else {\n        StreamingHelper.startFrameRefreshTimer(realtime, function () {\n          scroll(me);\n        });\n        realtime.head = Date.now();\n      }\n\n      return TimeScale.prototype.update.apply(me, arguments);\n    },\n    buildTicks: function buildTicks() {\n      var me = this;\n      var options = me.options; // For backwards compatibility\n\n      if (options.type === 'time' && !me.chart.options.plugins.streaming) {\n        return TimeScale.prototype.buildTicks.apply(me, arguments);\n      }\n\n      var timeOpts = options.time;\n      var majorTicksOpts = options.ticks.major;\n      var duration = resolveOption(me, 'duration');\n      var delay = resolveOption(me, 'delay');\n      var refresh = resolveOption(me, 'refresh');\n      var bounds = options.bounds;\n      var distribution = options.distribution;\n      var offset = options.offset;\n      var minTime = timeOpts.min;\n      var maxTime = timeOpts.max;\n      var majorEnabled = majorTicksOpts.enabled;\n      var max = me.realtime.head - delay;\n      var min = max - duration;\n      var maxArray = [max + refresh, max];\n      var ticks;\n      options.bounds = undefined;\n      options.distribution = 'linear';\n      options.offset = false;\n      timeOpts.min = -1e15;\n      timeOpts.max = 1e15;\n      majorTicksOpts.enabled = true;\n      Object.defineProperty(me, 'min', {\n        get: function get() {\n          return min;\n        },\n        set: helpers$1.noop\n      });\n      Object.defineProperty(me, 'max', {\n        get: function get() {\n          return maxArray.shift();\n        },\n        set: helpers$1.noop\n      });\n      ticks = TimeScale.prototype.buildTicks.apply(me, arguments);\n      delete me.min;\n      delete me.max;\n      me.min = min;\n      me.max = max;\n      options.bounds = bounds;\n      options.distribution = distribution;\n      options.offset = offset;\n      timeOpts.min = minTime;\n      timeOpts.max = maxTime;\n      majorTicksOpts.enabled = majorEnabled;\n      me._table = [{\n        time: min,\n        pos: 0\n      }, {\n        time: max,\n        pos: 1\n      }];\n      return ticks;\n    },\n    fit: function fit() {\n      var me = this;\n      var options = me.options;\n      TimeScale.prototype.fit.apply(me, arguments); // For backwards compatibility\n\n      if (options.type === 'time' && !me.chart.options.plugins.streaming) {\n        return;\n      }\n\n      if (options.ticks.display && options.display && me.isHorizontal()) {\n        me.paddingLeft = 3;\n        me.paddingRight = 3;\n        me.handleMargins();\n      }\n    },\n    draw: function draw(chartArea) {\n      var me = this;\n      var chart = me.chart; // For backwards compatibility\n\n      if (me.options.type === 'time' && !chart.options.plugins.streaming) {\n        TimeScale.prototype.draw.apply(me, arguments);\n        return;\n      }\n\n      var context = me.ctx;\n      var clipArea = me.isHorizontal() ? {\n        left: chartArea.left,\n        top: 0,\n        right: chartArea.right,\n        bottom: chart.height\n      } : {\n        left: 0,\n        top: chartArea.top,\n        right: chart.width,\n        bottom: chartArea.bottom\n      }; // Clip and draw the scale\n\n      canvasHelpers.clipArea(context, clipArea);\n      TimeScale.prototype.draw.apply(me, arguments);\n      canvasHelpers.unclipArea(context);\n    },\n    destroy: function destroy() {\n      var me = this; // For backwards compatibility\n\n      if (me.options.type === 'time' && !me.chart.options.plugins.streaming) {\n        return;\n      }\n\n      StreamingHelper.stopFrameRefreshTimer(me.realtime);\n      stopDataRefreshTimer(me);\n    },\n\n    /*\n     * @private\n     */\n    _getTimeForIndex: function _getTimeForIndex(index, datasetIndex) {\n      var me = this;\n      var timestamps = me._timestamps;\n      var time = timestamps.datasets[datasetIndex][index];\n      var value;\n\n      if (helpers$1.isNullOrUndef(time)) {\n        value = me.chart.data.datasets[datasetIndex].data[index];\n\n        if (helpers$1.isObject(value)) {\n          time = parse(me, value);\n        } else {\n          time = parse(me, timestamps.labels[index]);\n        }\n      }\n\n      return time;\n    }\n  });\n  scaleService.registerScaleType('realtime', RealTimeScale, defaultConfig);\n  var helpers$2 = Chart.helpers;\n  var canvasHelpers$1 = helpers$2.canvas;\n  Chart.defaults.global.plugins.streaming = {\n    duration: 10000,\n    delay: 0,\n    frameRate: 30,\n    refresh: 1000,\n    onRefresh: null,\n    pause: false,\n    ttl: undefined\n  };\n  /**\n   * Update the chart keeping the current animation but suppressing a new one\n   * @param {object} config - animation options\n   */\n\n  function update(config) {\n    var me = this;\n    var preservation = config && config.preservation;\n    var tooltip, lastActive, tooltipLastActive, lastMouseEvent;\n\n    if (preservation) {\n      tooltip = me.tooltip;\n      lastActive = me.lastActive;\n      tooltipLastActive = tooltip._lastActive;\n      me._bufferedRender = true;\n    }\n\n    Chart.prototype.update.apply(me, arguments);\n\n    if (preservation) {\n      me._bufferedRender = false;\n      me._bufferedRequest = null;\n      me.lastActive = lastActive;\n      tooltip._lastActive = tooltipLastActive;\n\n      if (me.animating) {\n        // If the chart is animating, keep it until the duration is over\n        Chart.animationService.animations.forEach(function (animation) {\n          if (animation.chart === me) {\n            me.render({\n              duration: (animation.numSteps - animation.currentStep) * 16.66\n            });\n          }\n        });\n      } else {\n        // If the chart is not animating, make sure that all elements are at the final positions\n        me.data.datasets.forEach(function (dataset, datasetIndex) {\n          me.getDatasetMeta(datasetIndex).controller.transition(1);\n        });\n      }\n\n      if (tooltip._active) {\n        tooltip.update(true);\n      }\n\n      lastMouseEvent = me.streaming.lastMouseEvent;\n\n      if (lastMouseEvent) {\n        me.eventHandler(lastMouseEvent);\n      }\n    }\n  } // Draw chart at frameRate\n\n\n  function drawChart(chart) {\n    var streaming = chart.streaming;\n    var frameRate = chart.options.plugins.streaming.frameRate;\n    var frameDuration = 1000 / (Math.max(frameRate, 0) || 30);\n    var next = streaming.lastDrawn + frameDuration || 0;\n    var now = Date.now();\n    var lastMouseEvent = streaming.lastMouseEvent;\n\n    if (next <= now) {\n      // Draw only when animation is inactive\n      if (!chart.animating && !chart.tooltip._start) {\n        chart.draw();\n      }\n\n      if (lastMouseEvent) {\n        chart.eventHandler(lastMouseEvent);\n      }\n\n      streaming.lastDrawn = next + frameDuration > now ? next : now;\n    }\n  }\n\n  var StreamingPlugin = {\n    id: 'streaming',\n    beforeInit: function beforeInit(chart) {\n      var streaming = chart.streaming = chart.streaming || {};\n      var canvas = streaming.canvas = chart.canvas;\n\n      var mouseEventListener = streaming.mouseEventListener = function (event) {\n        var pos = helpers$2.getRelativePosition(event, chart);\n        streaming.lastMouseEvent = {\n          type: 'mousemove',\n          chart: chart,\n          native: event,\n          x: pos.x,\n          y: pos.y\n        };\n      };\n\n      canvas.addEventListener('mousedown', mouseEventListener);\n      canvas.addEventListener('mouseup', mouseEventListener);\n    },\n    afterInit: function afterInit(chart) {\n      chart.update = update;\n\n      if (chart.resetZoom) {\n        Chart.Zoom.updateResetZoom(chart);\n      }\n    },\n    beforeUpdate: function beforeUpdate(chart) {\n      var chartOpts = chart.options;\n      var scalesOpts = chartOpts.scales;\n\n      if (scalesOpts) {\n        scalesOpts.xAxes.concat(scalesOpts.yAxes).forEach(function (scaleOpts) {\n          if (scaleOpts.type === 'realtime' || scaleOpts.type === 'time') {\n            // Allow BÃ©zier control to be outside the chart\n            chartOpts.elements.line.capBezierPoints = false;\n          }\n        });\n      }\n\n      return true;\n    },\n    afterUpdate: function afterUpdate(chart, options) {\n      var streaming = chart.streaming;\n      var pause = true; // if all scales are paused, stop refreshing frames\n\n      helpers$2.each(chart.scales, function (scale) {\n        if (scale instanceof RealTimeScale) {\n          pause &= helpers$2.valueOrDefault(scale.options.realtime.pause, options.pause);\n        }\n      });\n\n      if (pause) {\n        StreamingHelper.stopFrameRefreshTimer(streaming);\n      } else {\n        StreamingHelper.startFrameRefreshTimer(streaming, function () {\n          drawChart(chart);\n        });\n      }\n    },\n    beforeDatasetDraw: function beforeDatasetDraw(chart, args) {\n      var meta = args.meta;\n      var chartArea = chart.chartArea;\n      var clipArea = {\n        left: 0,\n        top: 0,\n        right: chart.width,\n        bottom: chart.height\n      };\n\n      if (meta.xAxisID && meta.controller.getScaleForId(meta.xAxisID) instanceof RealTimeScale) {\n        clipArea.left = chartArea.left;\n        clipArea.right = chartArea.right;\n      }\n\n      if (meta.yAxisID && meta.controller.getScaleForId(meta.yAxisID) instanceof RealTimeScale) {\n        clipArea.top = chartArea.top;\n        clipArea.bottom = chartArea.bottom;\n      }\n\n      canvasHelpers$1.clipArea(chart.ctx, clipArea);\n      return true;\n    },\n    afterDatasetDraw: function afterDatasetDraw(chart) {\n      canvasHelpers$1.unclipArea(chart.ctx);\n    },\n    beforeEvent: function beforeEvent(chart, event) {\n      var streaming = chart.streaming;\n\n      if (event.type === 'mousemove') {\n        // Save mousemove event for reuse\n        streaming.lastMouseEvent = event;\n      } else if (event.type === 'mouseout') {\n        // Remove mousemove event\n        delete streaming.lastMouseEvent;\n      }\n\n      return true;\n    },\n    destroy: function destroy(chart) {\n      var streaming = chart.streaming;\n      var canvas = streaming.canvas;\n      var mouseEventListener = streaming.mouseEventListener;\n      StreamingHelper.stopFrameRefreshTimer(streaming);\n      canvas.removeEventListener('mousedown', mouseEventListener);\n      canvas.removeEventListener('mouseup', mouseEventListener);\n      helpers$2.each(chart.scales, function (scale) {\n        if (scale instanceof RealTimeScale) {\n          scale.destroy();\n        }\n      });\n    }\n  };\n  var helpers$3 = Chart.helpers; // Ported from chartjs-plugin-zoom 0.7.0 3c187b7\n\n  var zoomNS = Chart.Zoom = Chart.Zoom || {}; // Ported from chartjs-plugin-zoom 0.7.0 3c187b7\n\n  zoomNS.zoomFunctions = zoomNS.zoomFunctions || {};\n  zoomNS.panFunctions = zoomNS.panFunctions || {}; // Ported from chartjs-plugin-zoom 0.7.0 3c187b7\n\n  function rangeMaxLimiter(zoomPanOptions, newMax) {\n    if (zoomPanOptions.scaleAxes && zoomPanOptions.rangeMax && !helpers$3.isNullOrUndef(zoomPanOptions.rangeMax[zoomPanOptions.scaleAxes])) {\n      var rangeMax = zoomPanOptions.rangeMax[zoomPanOptions.scaleAxes];\n\n      if (newMax > rangeMax) {\n        newMax = rangeMax;\n      }\n    }\n\n    return newMax;\n  } // Ported from chartjs-plugin-zoom 0.7.0 3c187b7\n\n\n  function rangeMinLimiter(zoomPanOptions, newMin) {\n    if (zoomPanOptions.scaleAxes && zoomPanOptions.rangeMin && !helpers$3.isNullOrUndef(zoomPanOptions.rangeMin[zoomPanOptions.scaleAxes])) {\n      var rangeMin = zoomPanOptions.rangeMin[zoomPanOptions.scaleAxes];\n\n      if (newMin < rangeMin) {\n        newMin = rangeMin;\n      }\n    }\n\n    return newMin;\n  }\n\n  function zoomRealTimeScale(scale, zoom, center, zoomOptions) {\n    var realtimeOpts = scale.options.realtime;\n    var streamingOpts = scale.chart.options.plugins.streaming;\n    var duration = helpers$3.valueOrDefault(realtimeOpts.duration, streamingOpts.duration);\n    var delay = helpers$3.valueOrDefault(realtimeOpts.delay, streamingOpts.delay);\n    var newDuration = duration * (2 - zoom);\n    var maxPercent, limitedDuration;\n\n    if (scale.isHorizontal()) {\n      maxPercent = (scale.right - center.x) / (scale.right - scale.left);\n    } else {\n      maxPercent = (scale.bottom - center.y) / (scale.bottom - scale.top);\n    }\n\n    if (zoom < 1) {\n      limitedDuration = rangeMaxLimiter(zoomOptions, newDuration);\n    } else {\n      limitedDuration = rangeMinLimiter(zoomOptions, newDuration);\n    }\n\n    realtimeOpts.duration = limitedDuration;\n    realtimeOpts.delay = delay + maxPercent * (duration - limitedDuration);\n  }\n\n  function panRealTimeScale(scale, delta, panOptions) {\n    var realtimeOpts = scale.options.realtime;\n    var streamingOpts = scale.chart.options.plugins.streaming;\n    var delay = helpers$3.valueOrDefault(realtimeOpts.delay, streamingOpts.delay);\n    var newDelay = delay + (scale.getValueForPixel(delta) - scale.getValueForPixel(0));\n\n    if (delta > 0) {\n      realtimeOpts.delay = rangeMaxLimiter(panOptions, newDelay);\n    } else {\n      realtimeOpts.delay = rangeMinLimiter(panOptions, newDelay);\n    }\n  }\n\n  zoomNS.zoomFunctions.realtime = zoomRealTimeScale;\n  zoomNS.panFunctions.realtime = panRealTimeScale;\n\n  function updateResetZoom(chart) {\n    // For chartjs-plugin-zoom 0.6.6 backward compatibility\n    var zoom = chart.$zoom || {\n      _originalOptions: {}\n    };\n    var resetZoom = chart.resetZoom;\n    var update = chart.update;\n\n    var resetZoomAndUpdate = function resetZoomAndUpdate() {\n      helpers$3.each(chart.scales, function (scale) {\n        var realtimeOptions = scale.options.realtime;\n        var originalOptions = zoom._originalOptions[scale.id] || scale.originalOptions;\n\n        if (realtimeOptions) {\n          if (originalOptions) {\n            realtimeOptions.duration = originalOptions.realtime.duration;\n            realtimeOptions.delay = originalOptions.realtime.delay;\n          } else {\n            delete realtimeOptions.duration;\n            delete realtimeOptions.delay;\n          }\n        }\n      });\n      update.call(chart, {\n        duration: 0\n      });\n    };\n\n    chart.resetZoom = function () {\n      chart.update = resetZoomAndUpdate;\n      resetZoom();\n      chart.update = update;\n    };\n  }\n\n  zoomNS.updateResetZoom = updateResetZoom;\n  Chart.helpers.streaming = StreamingHelper;\n  Chart.plugins.register(StreamingPlugin);\n  return StreamingPlugin;\n});","map":{"version":3,"sources":["/home/mohamed/projects/ESense/react-ui/node_modules/chartjs-plugin-streaming/dist/chartjs-plugin-streaming.js"],"names":["global","factory","exports","module","require","define","amd","self","ChartStreaming","Chart","moment","hasOwnProperty","helpers","cancelAnimFrame","window","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","oCancelAnimationFrame","msCancelAnimationFrame","id","clearTimeout","StreamingHelper","startFrameRefreshTimer","context","func","frameRequestID","frameRefresh","requestAnimFrame","call","stopFrameRefreshTimer","helpers$1","canvasHelpers","canvas","scaleService","TimeScale","getScaleConstructor","type","constructors","undefined","defaultAdapter","parse","value","format","isValid","valueOf","toTimestamp","scale","input","adapter","_adapter","options","time","parser","Number","isFinite","isNullOrUndef","getRightValue","round","startOf","resolveOption","key","realtimeOpts","realtime","streamingOpts","chart","plugins","streaming","valueOrDefault","datasetPropertyKeys","refreshData","duration","delay","ttl","pause","onRefresh","max","min","Date","now","isNaN","meta","data","length","i","start","count","removalRange","datasets","forEach","dataset","datasetIndex","getDatasetMeta","xAxisID","yAxisID","_getTimeForIndex","Math","splice","isArray","each","datalabels","labels","update","preservation","stopDataRefreshTimer","refreshTimerID","clearInterval","refreshInterval","startDataRefreshTimer","interval","setInterval","newInterval","transitionKeys","x","tooltip","y","transition","element","keys","translate","_start","view","_view","model","_model","ilen","scroll","activeTooltip","_active","offset","elements","isHorizontal","width","height","head","ticks","reverse","_datasetIndex","_table","defaultConfig","position","distribution","bounds","adapters","unit","displayFormat","isoWeekday","minUnit","displayFormats","millisecond","second","minute","hour","day","week","month","quarter","year","autoSkip","source","major","enabled","RealTimeScale","extend","initialize","me","prototype","apply","arguments","buildTicks","timeOpts","majorTicksOpts","refresh","minTime","maxTime","majorEnabled","maxArray","Object","defineProperty","get","set","noop","shift","pos","fit","display","paddingLeft","paddingRight","handleMargins","draw","chartArea","ctx","clipArea","left","top","right","bottom","unclipArea","destroy","index","timestamps","_timestamps","isObject","registerScaleType","helpers$2","canvasHelpers$1","defaults","frameRate","config","lastActive","tooltipLastActive","lastMouseEvent","_lastActive","_bufferedRender","_bufferedRequest","animating","animationService","animations","animation","render","numSteps","currentStep","controller","eventHandler","drawChart","frameDuration","next","lastDrawn","StreamingPlugin","beforeInit","mouseEventListener","event","getRelativePosition","native","addEventListener","afterInit","resetZoom","Zoom","updateResetZoom","beforeUpdate","chartOpts","scalesOpts","scales","xAxes","concat","yAxes","scaleOpts","line","capBezierPoints","afterUpdate","beforeDatasetDraw","args","getScaleForId","afterDatasetDraw","beforeEvent","removeEventListener","helpers$3","zoomNS","zoomFunctions","panFunctions","rangeMaxLimiter","zoomPanOptions","newMax","scaleAxes","rangeMax","rangeMinLimiter","newMin","rangeMin","zoomRealTimeScale","zoom","center","zoomOptions","newDuration","maxPercent","limitedDuration","panRealTimeScale","delta","panOptions","newDelay","getValueForPixel","$zoom","_originalOptions","resetZoomAndUpdate","realtimeOptions","originalOptions","register"],"mappings":"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","sourcesContent":["/*!\n * chartjs-plugin-streaming v1.8.0\n * https://nagix.github.io/chartjs-plugin-streaming\n * (c) 2019 Akihiko Kusanagi\n * Released under the MIT license\n */\n(function (global, factory) {\ntypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('chart.js'), require('moment')) :\ntypeof define === 'function' && define.amd ? define(['chart.js', 'moment'], factory) :\n(global = global || self, global.ChartStreaming = factory(global.Chart, global.moment));\n}(this, function (Chart, moment) { 'use strict';\n\nChart = Chart && Chart.hasOwnProperty('default') ? Chart['default'] : Chart;\nmoment = moment && moment.hasOwnProperty('default') ? moment['default'] : moment;\n\nvar helpers = Chart.helpers;\n\nvar cancelAnimFrame = (function() {\n\tif (typeof window !== 'undefined') {\n\t\treturn window.cancelAnimationFrame ||\n\t\t\twindow.webkitCancelAnimationFrame ||\n\t\t\twindow.mozCancelAnimationFrame ||\n\t\t\twindow.oCancelAnimationFrame ||\n\t\t\twindow.msCancelAnimationFrame ||\n\t\t\tfunction(id) {\n\t\t\t\treturn window.clearTimeout(id);\n\t\t\t};\n\t}\n}());\n\nvar StreamingHelper = {\n\n\tstartFrameRefreshTimer: function(context, func) {\n\t\tif (!context.frameRequestID) {\n\t\t\tvar frameRefresh = function() {\n\t\t\t\tfunc();\n\t\t\t\tcontext.frameRequestID = helpers.requestAnimFrame.call(window, frameRefresh);\n\t\t\t};\n\t\t\tcontext.frameRequestID = helpers.requestAnimFrame.call(window, frameRefresh);\n\t\t}\n\t},\n\n\tstopFrameRefreshTimer: function(context) {\n\t\tvar frameRequestID = context.frameRequestID;\n\n\t\tif (frameRequestID) {\n\t\t\tcancelAnimFrame.call(window, frameRequestID);\n\t\t\tdelete context.frameRequestID;\n\t\t}\n\t}\n\n};\n\nvar helpers$1 = Chart.helpers;\nvar canvasHelpers = helpers$1.canvas;\nvar scaleService = Chart.scaleService;\nvar TimeScale = scaleService.getScaleConstructor('time');\n\nscaleService.getScaleConstructor = function(type) {\n\t// For backwards compatibility\n\tif (type === 'time') {\n\t\ttype = 'realtime';\n\t}\n\treturn this.constructors.hasOwnProperty(type) ? this.constructors[type] : undefined;\n};\n\n// For Chart.js 2.7.x backward compatibility\nvar defaultAdapter = {\n\t// Ported from Chart.js 2.8.0-rc.1 35273ee\n\tparse: function(value, format) {\n\t\tif (typeof value === 'string' && typeof format === 'string') {\n\t\t\tvalue = moment(value, format);\n\t\t} else if (!(value instanceof moment)) {\n\t\t\tvalue = moment(value);\n\t\t}\n\t\treturn value.isValid() ? value.valueOf() : null;\n\t}\n};\n\n// Ported from Chart.js 2.8.0-rc.1 35273ee. Modified for Chart.js 2.7.x backward compatibility.\nfunction toTimestamp(scale, input) {\n\tvar adapter = scale._adapter || defaultAdapter;\n\tvar options = scale.options.time;\n\tvar parser = options.parser;\n\tvar format = parser || options.format;\n\tvar value = input;\n\n\tif (typeof parser === 'function') {\n\t\tvalue = parser(value);\n\t}\n\n\t// Only parse if its not a timestamp already\n\tif (typeof value !== 'number' && !(value instanceof Number) || !isFinite(value)) {\n\t\tvalue = typeof format === 'string'\n\t\t\t? adapter.parse(value, format)\n\t\t\t: adapter.parse(value);\n\t}\n\n\tif (value !== null) {\n\t\treturn +value;\n\t}\n\n\t// Labels are in an incompatible format and no `parser` has been provided.\n\t// The user might still use the deprecated `format` option for parsing.\n\tif (!parser && typeof format === 'function') {\n\t\tvalue = format(input);\n\n\t\t// `format` could return something else than a timestamp, if so, parse it\n\t\tif (typeof value !== 'number' && !(value instanceof Number) || !isFinite(value)) {\n\t\t\tvalue = adapter.parse(value);\n\t\t}\n\t}\n\n\treturn value;\n}\n\n// Ported from Chart.js 2.8.0-rc.1 35273ee\nfunction parse(scale, input) {\n\tif (helpers$1.isNullOrUndef(input)) {\n\t\treturn null;\n\t}\n\n\tvar options = scale.options.time;\n\tvar value = toTimestamp(scale, scale.getRightValue(input));\n\tif (value === null) {\n\t\treturn value;\n\t}\n\n\tif (options.round) {\n\t\tvalue = +scale._adapter.startOf(value, options.round);\n\t}\n\n\treturn value;\n}\n\nfunction resolveOption(scale, key) {\n\tvar realtimeOpts = scale.options.realtime;\n\tvar streamingOpts = scale.chart.options.plugins.streaming;\n\treturn helpers$1.valueOrDefault(realtimeOpts[key], streamingOpts[key]);\n}\n\nvar datasetPropertyKeys = [\n\t'pointBackgroundColor',\n\t'pointBorderColor',\n\t'pointBorderWidth',\n\t'pointRadius',\n\t'pointRotation',\n\t'pointStyle',\n\t'pointHitRadius',\n\t'pointHoverBackgroundColor',\n\t'pointHoverBorderColor',\n\t'pointHoverBorderWidth',\n\t'pointHoverRadius',\n\t'backgroundColor',\n\t'borderColor',\n\t'borderSkipped',\n\t'borderWidth',\n\t'hoverBackgroundColor',\n\t'hoverBorderColor',\n\t'hoverBorderWidth',\n\t'hoverRadius',\n\t'hitRadius',\n\t'radius',\n\t'rotation'\n];\n\nfunction refreshData(scale) {\n\tvar chart = scale.chart;\n\tvar id = scale.id;\n\tvar duration = resolveOption(scale, 'duration');\n\tvar delay = resolveOption(scale, 'delay');\n\tvar ttl = resolveOption(scale, 'ttl');\n\tvar pause = resolveOption(scale, 'pause');\n\tvar onRefresh = resolveOption(scale, 'onRefresh');\n\tvar max = scale.max;\n\tvar min = Date.now() - (isNaN(ttl) ? duration + delay : ttl);\n\tvar meta, data, length, i, start, count, removalRange;\n\n\tif (onRefresh) {\n\t\tonRefresh(chart);\n\t}\n\n\t// Remove old data\n\tchart.data.datasets.forEach(function(dataset, datasetIndex) {\n\t\tmeta = chart.getDatasetMeta(datasetIndex);\n\t\tif (id === meta.xAxisID || id === meta.yAxisID) {\n\t\t\tdata = dataset.data;\n\t\t\tlength = data.length;\n\n\t\t\tif (pause) {\n\t\t\t\t// If the scale is paused, preserve the visible data points\n\t\t\t\tfor (i = 0; i < length; ++i) {\n\t\t\t\t\tif (!(scale._getTimeForIndex(i, datasetIndex) < max)) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tstart = i + 2;\n\t\t\t} else {\n\t\t\t\tstart = 0;\n\t\t\t}\n\n\t\t\tfor (i = start; i < length; ++i) {\n\t\t\t\tif (!(scale._getTimeForIndex(i, datasetIndex) <= min)) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tcount = i - start;\n\t\t\tif (isNaN(ttl)) {\n\t\t\t\t// Keep the last two data points outside the range not to affect the existing bezier curve\n\t\t\t\tcount = Math.max(count - 2, 0);\n\t\t\t}\n\n\t\t\tdata.splice(start, count);\n\t\t\tdatasetPropertyKeys.forEach(function(key) {\n\t\t\t\tif (dataset.hasOwnProperty(key) && helpers$1.isArray(dataset[key])) {\n\t\t\t\t\tdataset[key].splice(start, count);\n\t\t\t\t}\n\t\t\t});\n\t\t\thelpers$1.each(dataset.datalabels, function(value) {\n\t\t\t\tif (helpers$1.isArray(value)) {\n\t\t\t\t\tvalue.splice(start, count);\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (typeof data[0] !== 'object') {\n\t\t\t\tremovalRange = {\n\t\t\t\t\tstart: start,\n\t\t\t\t\tcount: count\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t});\n\tif (removalRange) {\n\t\tchart.data.labels.splice(removalRange.start, removalRange.count);\n\t}\n\n\tchart.update({\n\t\tpreservation: true\n\t});\n}\n\nfunction stopDataRefreshTimer(scale) {\n\tvar realtime = scale.realtime;\n\tvar refreshTimerID = realtime.refreshTimerID;\n\n\tif (refreshTimerID) {\n\t\tclearInterval(refreshTimerID);\n\t\tdelete realtime.refreshTimerID;\n\t\tdelete realtime.refreshInterval;\n\t}\n}\n\nfunction startDataRefreshTimer(scale) {\n\tvar realtime = scale.realtime;\n\tvar interval = resolveOption(scale, 'refresh');\n\n\trealtime.refreshTimerID = setInterval(function() {\n\t\tvar newInterval = resolveOption(scale, 'refresh');\n\n\t\trefreshData(scale);\n\t\tif (realtime.refreshInterval !== newInterval && !isNaN(newInterval)) {\n\t\t\tstopDataRefreshTimer(scale);\n\t\t\tstartDataRefreshTimer(scale);\n\t\t}\n\t}, interval);\n\trealtime.refreshInterval = interval;\n}\n\nvar transitionKeys = {\n\tx: {\n\t\tdata: ['x', 'controlPointPreviousX', 'controlPointNextX'],\n\t\tdataset: ['x'],\n\t\ttooltip: ['x', 'caretX']\n\t},\n\ty: {\n\t\tdata: ['y', 'controlPointPreviousY', 'controlPointNextY'],\n\t\tdataset: ['y'],\n\t\ttooltip: ['y', 'caretY']\n\t}\n};\n\nfunction transition(element, keys, translate) {\n\tvar start = element._start || {};\n\tvar view = element._view || {};\n\tvar model = element._model || {};\n\tvar i, ilen;\n\n\tfor (i = 0, ilen = keys.length; i < ilen; ++i) {\n\t\tvar key = keys[i];\n\t\tif (start.hasOwnProperty(key)) {\n\t\t\tstart[key] -= translate;\n\t\t}\n\t\tif (view.hasOwnProperty(key) && view !== start) {\n\t\t\tview[key] -= translate;\n\t\t}\n\t\tif (model.hasOwnProperty(key) && model !== view) {\n\t\t\tmodel[key] -= translate;\n\t\t}\n\t}\n}\n\nfunction scroll(scale) {\n\tvar chart = scale.chart;\n\tvar realtime = scale.realtime;\n\tvar duration = resolveOption(scale, 'duration');\n\tvar delay = resolveOption(scale, 'delay');\n\tvar id = scale.id;\n\tvar tooltip = chart.tooltip;\n\tvar activeTooltip = tooltip._active;\n\tvar now = Date.now();\n\tvar length, keys, offset, meta, elements, i, ilen;\n\n\tif (scale.isHorizontal()) {\n\t\tlength = scale.width;\n\t\tkeys = transitionKeys.x;\n\t} else {\n\t\tlength = scale.height;\n\t\tkeys = transitionKeys.y;\n\t}\n\toffset = length * (now - realtime.head) / duration;\n\n\tif (scale.options.ticks.reverse) {\n\t\toffset = -offset;\n\t}\n\n\t// Shift all the elements leftward or upward\n\thelpers$1.each(chart.data.datasets, function(dataset, datasetIndex) {\n\t\tmeta = chart.getDatasetMeta(datasetIndex);\n\t\tif (id === meta.xAxisID || id === meta.yAxisID) {\n\t\t\telements = meta.data || [];\n\n\t\t\tfor (i = 0, ilen = elements.length; i < ilen; ++i) {\n\t\t\t\ttransition(elements[i], keys.data, offset);\n\t\t\t}\n\n\t\t\tif (meta.dataset) {\n\t\t\t\ttransition(meta.dataset, keys.dataset, offset);\n\t\t\t}\n\t\t}\n\t});\n\n\t// Shift tooltip leftward or upward\n\tif (activeTooltip && activeTooltip[0]) {\n\t\tmeta = chart.getDatasetMeta(activeTooltip[0]._datasetIndex);\n\t\tif (id === meta.xAxisID || id === meta.yAxisID) {\n\t\t\ttransition(tooltip, keys.tooltip, offset);\n\t\t}\n\t}\n\n\tscale.max = scale._table[1].time = now - delay;\n\tscale.min = scale._table[0].time = scale.max - duration;\n\n\trealtime.head = now;\n}\n\nvar defaultConfig = {\n\tposition: 'bottom',\n\tdistribution: 'linear',\n\tbounds: 'data',\n\tadapters: {},\n\ttime: {\n\t\tparser: false, // false == a pattern string from http://momentjs.com/docs/#/parsing/string-format/ or a custom callback that converts its argument to a moment\n\t\tformat: false, // DEPRECATED false == date objects, moment object, callback or a pattern string from http://momentjs.com/docs/#/parsing/string-format/\n\t\tunit: false, // false == automatic or override with week, month, year, etc.\n\t\tround: false, // none, or override with week, month, year, etc.\n\t\tdisplayFormat: false, // DEPRECATED\n\t\tisoWeekday: false, // override week start day - see http://momentjs.com/docs/#/get-set/iso-weekday/\n\t\tminUnit: 'millisecond',\n\n\t\t// defaults to unit's corresponding unitFormat below or override using pattern string from http://momentjs.com/docs/#/displaying/format/\n\t\tdisplayFormats: {\n\t\t\tmillisecond: 'h:mm:ss.SSS a',\n\t\t\tsecond: 'h:mm:ss a',\n\t\t\tminute: 'h:mm a',\n\t\t\thour: 'hA',\n\t\t\tday: 'MMM D',\n\t\t\tweek: 'll',\n\t\t\tmonth: 'MMM YYYY',\n\t\t\tquarter: '[Q]Q - YYYY',\n\t\t\tyear: 'YYYY'\n\t\t},\n\t},\n\trealtime: {},\n\tticks: {\n\t\tautoSkip: false,\n\t\tsource: 'auto',\n\t\tmajor: {\n\t\t\tenabled: true\n\t\t}\n\t}\n};\n\nvar RealTimeScale = TimeScale.extend({\n\tinitialize: function() {\n\t\tvar me = this;\n\n\t\tTimeScale.prototype.initialize.apply(me, arguments);\n\n\t\t// For backwards compatibility\n\t\tif (me.options.type === 'time' && !me.chart.options.plugins.streaming) {\n\t\t\treturn;\n\t\t}\n\n\t\tme.realtime = me.realtime || {};\n\n\t\tstartDataRefreshTimer(me);\n\t},\n\n\tupdate: function() {\n\t\tvar me = this;\n\t\tvar realtime = me.realtime;\n\n\t\t// For backwards compatibility\n\t\tif (me.options.type === 'time' && !me.chart.options.plugins.streaming) {\n\t\t\treturn TimeScale.prototype.update.apply(me, arguments);\n\t\t}\n\n\t\tif (resolveOption(me, 'pause')) {\n\t\t\tStreamingHelper.stopFrameRefreshTimer(realtime);\n\t\t} else {\n\t\t\tStreamingHelper.startFrameRefreshTimer(realtime, function() {\n\t\t\t\tscroll(me);\n\t\t\t});\n\t\t\trealtime.head = Date.now();\n\t\t}\n\n\t\treturn TimeScale.prototype.update.apply(me, arguments);\n\t},\n\n\tbuildTicks: function() {\n\t\tvar me = this;\n\t\tvar options = me.options;\n\n\t\t// For backwards compatibility\n\t\tif (options.type === 'time' && !me.chart.options.plugins.streaming) {\n\t\t\treturn TimeScale.prototype.buildTicks.apply(me, arguments);\n\t\t}\n\n\t\tvar timeOpts = options.time;\n\t\tvar majorTicksOpts = options.ticks.major;\n\t\tvar duration = resolveOption(me, 'duration');\n\t\tvar delay = resolveOption(me, 'delay');\n\t\tvar refresh = resolveOption(me, 'refresh');\n\t\tvar bounds = options.bounds;\n\t\tvar distribution = options.distribution;\n\t\tvar offset = options.offset;\n\t\tvar minTime = timeOpts.min;\n\t\tvar maxTime = timeOpts.max;\n\t\tvar majorEnabled = majorTicksOpts.enabled;\n\t\tvar max = me.realtime.head - delay;\n\t\tvar min = max - duration;\n\t\tvar maxArray = [max + refresh, max];\n\t\tvar ticks;\n\n\t\toptions.bounds = undefined;\n\t\toptions.distribution = 'linear';\n\t\toptions.offset = false;\n\t\ttimeOpts.min = -1e15;\n\t\ttimeOpts.max = 1e15;\n\t\tmajorTicksOpts.enabled = true;\n\n\t\tObject.defineProperty(me, 'min', {\n\t\t\tget: function() {\n\t\t\t\treturn min;\n\t\t\t},\n\t\t\tset: helpers$1.noop\n\t\t});\n\t\tObject.defineProperty(me, 'max', {\n\t\t\tget: function() {\n\t\t\t\treturn maxArray.shift();\n\t\t\t},\n\t\t\tset: helpers$1.noop\n\t\t});\n\n\t\tticks = TimeScale.prototype.buildTicks.apply(me, arguments);\n\n\t\tdelete me.min;\n\t\tdelete me.max;\n\n\t\tme.min = min;\n\t\tme.max = max;\n\t\toptions.bounds = bounds;\n\t\toptions.distribution = distribution;\n\t\toptions.offset = offset;\n\t\ttimeOpts.min = minTime;\n\t\ttimeOpts.max = maxTime;\n\t\tmajorTicksOpts.enabled = majorEnabled;\n\t\tme._table = [{time: min, pos: 0}, {time: max, pos: 1}];\n\n\t\treturn ticks;\n\t},\n\n\tfit: function() {\n\t\tvar me = this;\n\t\tvar options = me.options;\n\n\t\tTimeScale.prototype.fit.apply(me, arguments);\n\n\t\t// For backwards compatibility\n\t\tif (options.type === 'time' && !me.chart.options.plugins.streaming) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (options.ticks.display && options.display && me.isHorizontal()) {\n\t\t\tme.paddingLeft = 3;\n\t\t\tme.paddingRight = 3;\n\t\t\tme.handleMargins();\n\t\t}\n\t},\n\n\tdraw: function(chartArea) {\n\t\tvar me = this;\n\t\tvar chart = me.chart;\n\n\t\t// For backwards compatibility\n\t\tif (me.options.type === 'time' && !chart.options.plugins.streaming) {\n\t\t\tTimeScale.prototype.draw.apply(me, arguments);\n\t\t\treturn;\n\t\t}\n\n\t\tvar context = me.ctx;\n\t\tvar\tclipArea = me.isHorizontal() ?\n\t\t\t{\n\t\t\t\tleft: chartArea.left,\n\t\t\t\ttop: 0,\n\t\t\t\tright: chartArea.right,\n\t\t\t\tbottom: chart.height\n\t\t\t} : {\n\t\t\t\tleft: 0,\n\t\t\t\ttop: chartArea.top,\n\t\t\t\tright: chart.width,\n\t\t\t\tbottom: chartArea.bottom\n\t\t\t};\n\n\t\t// Clip and draw the scale\n\t\tcanvasHelpers.clipArea(context, clipArea);\n\t\tTimeScale.prototype.draw.apply(me, arguments);\n\t\tcanvasHelpers.unclipArea(context);\n\t},\n\n\tdestroy: function() {\n\t\tvar me = this;\n\n\t\t// For backwards compatibility\n\t\tif (me.options.type === 'time' && !me.chart.options.plugins.streaming) {\n\t\t\treturn;\n\t\t}\n\n\t\tStreamingHelper.stopFrameRefreshTimer(me.realtime);\n\t\tstopDataRefreshTimer(me);\n\t},\n\n\t/*\n\t * @private\n\t */\n\t_getTimeForIndex: function(index, datasetIndex) {\n\t\tvar me = this;\n\t\tvar timestamps = me._timestamps;\n\t\tvar time = timestamps.datasets[datasetIndex][index];\n\t\tvar value;\n\n\t\tif (helpers$1.isNullOrUndef(time)) {\n\t\t\tvalue = me.chart.data.datasets[datasetIndex].data[index];\n\t\t\tif (helpers$1.isObject(value)) {\n\t\t\t\ttime = parse(me, value);\n\t\t\t} else {\n\t\t\t\ttime = parse(me, timestamps.labels[index]);\n\t\t\t}\n\t\t}\n\n\t\treturn time;\n\t}\n});\n\nscaleService.registerScaleType('realtime', RealTimeScale, defaultConfig);\n\nvar helpers$2 = Chart.helpers;\nvar canvasHelpers$1 = helpers$2.canvas;\n\nChart.defaults.global.plugins.streaming = {\n\tduration: 10000,\n\tdelay: 0,\n\tframeRate: 30,\n\trefresh: 1000,\n\tonRefresh: null,\n\tpause: false,\n\tttl: undefined\n};\n\n/**\n * Update the chart keeping the current animation but suppressing a new one\n * @param {object} config - animation options\n */\nfunction update(config) {\n\tvar me = this;\n\tvar preservation = config && config.preservation;\n\tvar tooltip, lastActive, tooltipLastActive, lastMouseEvent;\n\n\tif (preservation) {\n\t\ttooltip = me.tooltip;\n\t\tlastActive = me.lastActive;\n\t\ttooltipLastActive = tooltip._lastActive;\n\t\tme._bufferedRender = true;\n\t}\n\n\tChart.prototype.update.apply(me, arguments);\n\n\tif (preservation) {\n\t\tme._bufferedRender = false;\n\t\tme._bufferedRequest = null;\n\t\tme.lastActive = lastActive;\n\t\ttooltip._lastActive = tooltipLastActive;\n\n\t\tif (me.animating) {\n\t\t\t// If the chart is animating, keep it until the duration is over\n\t\t\tChart.animationService.animations.forEach(function(animation) {\n\t\t\t\tif (animation.chart === me) {\n\t\t\t\t\tme.render({\n\t\t\t\t\t\tduration: (animation.numSteps - animation.currentStep) * 16.66\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\t// If the chart is not animating, make sure that all elements are at the final positions\n\t\t\tme.data.datasets.forEach(function(dataset, datasetIndex) {\n\t\t\t\tme.getDatasetMeta(datasetIndex).controller.transition(1);\n\t\t\t});\n\t\t}\n\n\t\tif (tooltip._active) {\n\t\t\ttooltip.update(true);\n\t\t}\n\n\t\tlastMouseEvent = me.streaming.lastMouseEvent;\n\t\tif (lastMouseEvent) {\n\t\t\tme.eventHandler(lastMouseEvent);\n\t\t}\n\t}\n}\n\n// Draw chart at frameRate\nfunction drawChart(chart) {\n\tvar streaming = chart.streaming;\n\tvar frameRate = chart.options.plugins.streaming.frameRate;\n\tvar frameDuration = 1000 / (Math.max(frameRate, 0) || 30);\n\tvar next = streaming.lastDrawn + frameDuration || 0;\n\tvar now = Date.now();\n\tvar lastMouseEvent = streaming.lastMouseEvent;\n\n\tif (next <= now) {\n\t\t// Draw only when animation is inactive\n\t\tif (!chart.animating && !chart.tooltip._start) {\n\t\t\tchart.draw();\n\t\t}\n\t\tif (lastMouseEvent) {\n\t\t\tchart.eventHandler(lastMouseEvent);\n\t\t}\n\t\tstreaming.lastDrawn = (next + frameDuration > now) ? next : now;\n\t}\n}\n\nvar StreamingPlugin = {\n\tid: 'streaming',\n\n\tbeforeInit: function(chart) {\n\t\tvar streaming = chart.streaming = chart.streaming || {};\n\t\tvar canvas = streaming.canvas = chart.canvas;\n\t\tvar mouseEventListener = streaming.mouseEventListener = function(event) {\n\t\t\tvar pos = helpers$2.getRelativePosition(event, chart);\n\t\t\tstreaming.lastMouseEvent = {\n\t\t\t\ttype: 'mousemove',\n\t\t\t\tchart: chart,\n\t\t\t\tnative: event,\n\t\t\t\tx: pos.x,\n\t\t\t\ty: pos.y\n\t\t\t};\n\t\t};\n\n\t\tcanvas.addEventListener('mousedown', mouseEventListener);\n\t\tcanvas.addEventListener('mouseup', mouseEventListener);\n\t},\n\n\tafterInit: function(chart) {\n\t\tchart.update = update;\n\n\t\tif (chart.resetZoom) {\n\t\t\tChart.Zoom.updateResetZoom(chart);\n\t\t}\n\t},\n\n\tbeforeUpdate: function(chart) {\n\t\tvar chartOpts = chart.options;\n\t\tvar scalesOpts = chartOpts.scales;\n\n\t\tif (scalesOpts) {\n\t\t\tscalesOpts.xAxes.concat(scalesOpts.yAxes).forEach(function(scaleOpts) {\n\t\t\t\tif (scaleOpts.type === 'realtime' || scaleOpts.type === 'time') {\n\t\t\t\t\t// Allow BÃ©zier control to be outside the chart\n\t\t\t\t\tchartOpts.elements.line.capBezierPoints = false;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn true;\n\t},\n\n\tafterUpdate: function(chart, options) {\n\t\tvar streaming = chart.streaming;\n\t\tvar pause = true;\n\n\t\t// if all scales are paused, stop refreshing frames\n\t\thelpers$2.each(chart.scales, function(scale) {\n\t\t\tif (scale instanceof RealTimeScale) {\n\t\t\t\tpause &= helpers$2.valueOrDefault(scale.options.realtime.pause, options.pause);\n\t\t\t}\n\t\t});\n\t\tif (pause) {\n\t\t\tStreamingHelper.stopFrameRefreshTimer(streaming);\n\t\t} else {\n\t\t\tStreamingHelper.startFrameRefreshTimer(streaming, function() {\n\t\t\t\tdrawChart(chart);\n\t\t\t});\n\t\t}\n\t},\n\n\tbeforeDatasetDraw: function(chart, args) {\n\t\tvar meta = args.meta;\n\t\tvar chartArea = chart.chartArea;\n\t\tvar clipArea = {\n\t\t\tleft: 0,\n\t\t\ttop: 0,\n\t\t\tright: chart.width,\n\t\t\tbottom: chart.height\n\t\t};\n\t\tif (meta.xAxisID && meta.controller.getScaleForId(meta.xAxisID) instanceof RealTimeScale) {\n\t\t\tclipArea.left = chartArea.left;\n\t\t\tclipArea.right = chartArea.right;\n\t\t}\n\t\tif (meta.yAxisID && meta.controller.getScaleForId(meta.yAxisID) instanceof RealTimeScale) {\n\t\t\tclipArea.top = chartArea.top;\n\t\t\tclipArea.bottom = chartArea.bottom;\n\t\t}\n\t\tcanvasHelpers$1.clipArea(chart.ctx, clipArea);\n\t\treturn true;\n\t},\n\n\tafterDatasetDraw: function(chart) {\n\t\tcanvasHelpers$1.unclipArea(chart.ctx);\n\t},\n\n\tbeforeEvent: function(chart, event) {\n\t\tvar streaming = chart.streaming;\n\n\t\tif (event.type === 'mousemove') {\n\t\t\t// Save mousemove event for reuse\n\t\t\tstreaming.lastMouseEvent = event;\n\t\t} else if (event.type === 'mouseout') {\n\t\t\t// Remove mousemove event\n\t\t\tdelete streaming.lastMouseEvent;\n\t\t}\n\t\treturn true;\n\t},\n\n\tdestroy: function(chart) {\n\t\tvar streaming = chart.streaming;\n\t\tvar canvas = streaming.canvas;\n\t\tvar mouseEventListener = streaming.mouseEventListener;\n\n\t\tStreamingHelper.stopFrameRefreshTimer(streaming);\n\n\t\tcanvas.removeEventListener('mousedown', mouseEventListener);\n\t\tcanvas.removeEventListener('mouseup', mouseEventListener);\n\n\t\thelpers$2.each(chart.scales, function(scale) {\n\t\t\tif (scale instanceof RealTimeScale) {\n\t\t\t\tscale.destroy();\n\t\t\t}\n\t\t});\n\t}\n};\n\nvar helpers$3 = Chart.helpers;\n\n// Ported from chartjs-plugin-zoom 0.7.0 3c187b7\nvar zoomNS = Chart.Zoom = Chart.Zoom || {};\n\n// Ported from chartjs-plugin-zoom 0.7.0 3c187b7\nzoomNS.zoomFunctions = zoomNS.zoomFunctions || {};\nzoomNS.panFunctions = zoomNS.panFunctions || {};\n\n// Ported from chartjs-plugin-zoom 0.7.0 3c187b7\nfunction rangeMaxLimiter(zoomPanOptions, newMax) {\n\tif (zoomPanOptions.scaleAxes && zoomPanOptions.rangeMax &&\n\t\t\t!helpers$3.isNullOrUndef(zoomPanOptions.rangeMax[zoomPanOptions.scaleAxes])) {\n\t\tvar rangeMax = zoomPanOptions.rangeMax[zoomPanOptions.scaleAxes];\n\t\tif (newMax > rangeMax) {\n\t\t\tnewMax = rangeMax;\n\t\t}\n\t}\n\treturn newMax;\n}\n\n// Ported from chartjs-plugin-zoom 0.7.0 3c187b7\nfunction rangeMinLimiter(zoomPanOptions, newMin) {\n\tif (zoomPanOptions.scaleAxes && zoomPanOptions.rangeMin &&\n\t\t\t!helpers$3.isNullOrUndef(zoomPanOptions.rangeMin[zoomPanOptions.scaleAxes])) {\n\t\tvar rangeMin = zoomPanOptions.rangeMin[zoomPanOptions.scaleAxes];\n\t\tif (newMin < rangeMin) {\n\t\t\tnewMin = rangeMin;\n\t\t}\n\t}\n\treturn newMin;\n}\n\nfunction zoomRealTimeScale(scale, zoom, center, zoomOptions) {\n\tvar realtimeOpts = scale.options.realtime;\n\tvar streamingOpts = scale.chart.options.plugins.streaming;\n\tvar duration = helpers$3.valueOrDefault(realtimeOpts.duration, streamingOpts.duration);\n\tvar delay = helpers$3.valueOrDefault(realtimeOpts.delay, streamingOpts.delay);\n\tvar newDuration = duration * (2 - zoom);\n\tvar maxPercent, limitedDuration;\n\n\tif (scale.isHorizontal()) {\n\t\tmaxPercent = (scale.right - center.x) / (scale.right - scale.left);\n\t} else {\n\t\tmaxPercent = (scale.bottom - center.y) / (scale.bottom - scale.top);\n\t}\n\tif (zoom < 1) {\n\t\tlimitedDuration = rangeMaxLimiter(zoomOptions, newDuration);\n\t} else {\n\t\tlimitedDuration = rangeMinLimiter(zoomOptions, newDuration);\n\t}\n\trealtimeOpts.duration = limitedDuration;\n\trealtimeOpts.delay = delay + maxPercent * (duration - limitedDuration);\n}\n\nfunction panRealTimeScale(scale, delta, panOptions) {\n\tvar realtimeOpts = scale.options.realtime;\n\tvar streamingOpts = scale.chart.options.plugins.streaming;\n\tvar delay = helpers$3.valueOrDefault(realtimeOpts.delay, streamingOpts.delay);\n\tvar newDelay = delay + (scale.getValueForPixel(delta) - scale.getValueForPixel(0));\n\n\tif (delta > 0) {\n\t\trealtimeOpts.delay = rangeMaxLimiter(panOptions, newDelay);\n\t} else {\n\t\trealtimeOpts.delay = rangeMinLimiter(panOptions, newDelay);\n\t}\n}\n\nzoomNS.zoomFunctions.realtime = zoomRealTimeScale;\nzoomNS.panFunctions.realtime = panRealTimeScale;\n\nfunction updateResetZoom(chart) {\n\t// For chartjs-plugin-zoom 0.6.6 backward compatibility\n\tvar zoom = chart.$zoom || {_originalOptions: {}};\n\n\tvar resetZoom = chart.resetZoom;\n\tvar update = chart.update;\n\tvar resetZoomAndUpdate = function() {\n\t\thelpers$3.each(chart.scales, function(scale) {\n\t\t\tvar realtimeOptions = scale.options.realtime;\n\t\t\tvar originalOptions = zoom._originalOptions[scale.id] || scale.originalOptions;\n\n\t\t\tif (realtimeOptions) {\n\t\t\t\tif (originalOptions) {\n\t\t\t\t\trealtimeOptions.duration = originalOptions.realtime.duration;\n\t\t\t\t\trealtimeOptions.delay = originalOptions.realtime.delay;\n\t\t\t\t} else {\n\t\t\t\t\tdelete realtimeOptions.duration;\n\t\t\t\t\tdelete realtimeOptions.delay;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tupdate.call(chart, {\n\t\t\tduration: 0\n\t\t});\n\t};\n\n\tchart.resetZoom = function() {\n\t\tchart.update = resetZoomAndUpdate;\n\t\tresetZoom();\n\t\tchart.update = update;\n\t};\n}\n\nzoomNS.updateResetZoom = updateResetZoom;\n\nChart.helpers.streaming = StreamingHelper;\n\nChart.plugins.register(StreamingPlugin);\n\nreturn StreamingPlugin;\n\n}));\n"]},"metadata":{},"sourceType":"script"}