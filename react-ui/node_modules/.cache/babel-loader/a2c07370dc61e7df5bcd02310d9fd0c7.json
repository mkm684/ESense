{"ast":null,"code":"'use strict';\n\nvar defaults = require('./core.defaults');\n\nvar helpers = require('../helpers/index');\n\nvar Interaction = require('./core.interaction');\n\nvar layouts = require('./core.layouts');\n\nvar platform = require('../platforms/platform');\n\nvar plugins = require('./core.plugins');\n\nmodule.exports = function (Chart) {\n  // Create a dictionary of chart types, to allow for extension of existing types\n  Chart.types = {}; // Store a reference to each instance - allowing us to globally resize chart instances on window resize.\n  // Destroy method on the chart will remove the instance of the chart from this reference.\n\n  Chart.instances = {}; // Controllers available for dataset visualization eg. bar, line, slice, etc.\n\n  Chart.controllers = {};\n  /**\n   * Initializes the given config with global and chart default values.\n   */\n\n  function initConfig(config) {\n    config = config || {}; // Do NOT use configMerge() for the data object because this method merges arrays\n    // and so would change references to labels and datasets, preventing data updates.\n\n    var data = config.data = config.data || {};\n    data.datasets = data.datasets || [];\n    data.labels = data.labels || [];\n    config.options = helpers.configMerge(defaults.global, defaults[config.type], config.options || {});\n    return config;\n  }\n  /**\n   * Updates the config of the chart\n   * @param chart {Chart} chart to update the options for\n   */\n\n\n  function updateConfig(chart) {\n    var newOptions = chart.options;\n    helpers.each(chart.scales, function (scale) {\n      layouts.removeBox(chart, scale);\n    });\n    newOptions = helpers.configMerge(Chart.defaults.global, Chart.defaults[chart.config.type], newOptions);\n    chart.options = chart.config.options = newOptions;\n    chart.ensureScalesHaveIDs();\n    chart.buildOrUpdateScales(); // Tooltip\n\n    chart.tooltip._options = newOptions.tooltips;\n    chart.tooltip.initialize();\n  }\n\n  function positionIsHorizontal(position) {\n    return position === 'top' || position === 'bottom';\n  }\n\n  helpers.extend(Chart.prototype,\n  /** @lends Chart */\n  {\n    /**\n     * @private\n     */\n    construct: function construct(item, config) {\n      var me = this;\n      config = initConfig(config);\n      var context = platform.acquireContext(item, config);\n      var canvas = context && context.canvas;\n      var height = canvas && canvas.height;\n      var width = canvas && canvas.width;\n      me.id = helpers.uid();\n      me.ctx = context;\n      me.canvas = canvas;\n      me.config = config;\n      me.width = width;\n      me.height = height;\n      me.aspectRatio = height ? width / height : null;\n      me.options = config.options;\n      me._bufferedRender = false;\n      /**\n       * Provided for backward compatibility, Chart and Chart.Controller have been merged,\n       * the \"instance\" still need to be defined since it might be called from plugins.\n       * @prop Chart#chart\n       * @deprecated since version 2.6.0\n       * @todo remove at version 3\n       * @private\n       */\n\n      me.chart = me;\n      me.controller = me; // chart.chart.controller #inception\n      // Add the chart instance to the global namespace\n\n      Chart.instances[me.id] = me; // Define alias to the config data: `chart.data === chart.config.data`\n\n      Object.defineProperty(me, 'data', {\n        get: function get() {\n          return me.config.data;\n        },\n        set: function set(value) {\n          me.config.data = value;\n        }\n      });\n\n      if (!context || !canvas) {\n        // The given item is not a compatible context2d element, let's return before finalizing\n        // the chart initialization but after setting basic chart / controller properties that\n        // can help to figure out that the chart is not valid (e.g chart.canvas !== null);\n        // https://github.com/chartjs/Chart.js/issues/2807\n        console.error(\"Failed to create chart: can't acquire context from the given item\");\n        return;\n      }\n\n      me.initialize();\n      me.update();\n    },\n\n    /**\n     * @private\n     */\n    initialize: function initialize() {\n      var me = this; // Before init plugin notification\n\n      plugins.notify(me, 'beforeInit');\n      helpers.retinaScale(me, me.options.devicePixelRatio);\n      me.bindEvents();\n\n      if (me.options.responsive) {\n        // Initial resize before chart draws (must be silent to preserve initial animations).\n        me.resize(true);\n      } // Make sure scales have IDs and are built before we build any controllers.\n\n\n      me.ensureScalesHaveIDs();\n      me.buildOrUpdateScales();\n      me.initToolTip(); // After init plugin notification\n\n      plugins.notify(me, 'afterInit');\n      return me;\n    },\n    clear: function clear() {\n      helpers.canvas.clear(this);\n      return this;\n    },\n    stop: function stop() {\n      // Stops any current animation loop occurring\n      Chart.animationService.cancelAnimation(this);\n      return this;\n    },\n    resize: function resize(silent) {\n      var me = this;\n      var options = me.options;\n      var canvas = me.canvas;\n      var aspectRatio = options.maintainAspectRatio && me.aspectRatio || null; // the canvas render width and height will be casted to integers so make sure that\n      // the canvas display style uses the same integer values to avoid blurring effect.\n      // Set to 0 instead of canvas.size because the size defaults to 300x150 if the element is collased\n\n      var newWidth = Math.max(0, Math.floor(helpers.getMaximumWidth(canvas)));\n      var newHeight = Math.max(0, Math.floor(aspectRatio ? newWidth / aspectRatio : helpers.getMaximumHeight(canvas)));\n\n      if (me.width === newWidth && me.height === newHeight) {\n        return;\n      }\n\n      canvas.width = me.width = newWidth;\n      canvas.height = me.height = newHeight;\n      canvas.style.width = newWidth + 'px';\n      canvas.style.height = newHeight + 'px';\n      helpers.retinaScale(me, options.devicePixelRatio);\n\n      if (!silent) {\n        // Notify any plugins about the resize\n        var newSize = {\n          width: newWidth,\n          height: newHeight\n        };\n        plugins.notify(me, 'resize', [newSize]); // Notify of resize\n\n        if (me.options.onResize) {\n          me.options.onResize(me, newSize);\n        }\n\n        me.stop();\n        me.update(me.options.responsiveAnimationDuration);\n      }\n    },\n    ensureScalesHaveIDs: function ensureScalesHaveIDs() {\n      var options = this.options;\n      var scalesOptions = options.scales || {};\n      var scaleOptions = options.scale;\n      helpers.each(scalesOptions.xAxes, function (xAxisOptions, index) {\n        xAxisOptions.id = xAxisOptions.id || 'x-axis-' + index;\n      });\n      helpers.each(scalesOptions.yAxes, function (yAxisOptions, index) {\n        yAxisOptions.id = yAxisOptions.id || 'y-axis-' + index;\n      });\n\n      if (scaleOptions) {\n        scaleOptions.id = scaleOptions.id || 'scale';\n      }\n    },\n\n    /**\n     * Builds a map of scale ID to scale object for future lookup.\n     */\n    buildOrUpdateScales: function buildOrUpdateScales() {\n      var me = this;\n      var options = me.options;\n      var scales = me.scales || {};\n      var items = [];\n      var updated = Object.keys(scales).reduce(function (obj, id) {\n        obj[id] = false;\n        return obj;\n      }, {});\n\n      if (options.scales) {\n        items = items.concat((options.scales.xAxes || []).map(function (xAxisOptions) {\n          return {\n            options: xAxisOptions,\n            dtype: 'category',\n            dposition: 'bottom'\n          };\n        }), (options.scales.yAxes || []).map(function (yAxisOptions) {\n          return {\n            options: yAxisOptions,\n            dtype: 'linear',\n            dposition: 'left'\n          };\n        }));\n      }\n\n      if (options.scale) {\n        items.push({\n          options: options.scale,\n          dtype: 'radialLinear',\n          isDefault: true,\n          dposition: 'chartArea'\n        });\n      }\n\n      helpers.each(items, function (item) {\n        var scaleOptions = item.options;\n        var id = scaleOptions.id;\n        var scaleType = helpers.valueOrDefault(scaleOptions.type, item.dtype);\n\n        if (positionIsHorizontal(scaleOptions.position) !== positionIsHorizontal(item.dposition)) {\n          scaleOptions.position = item.dposition;\n        }\n\n        updated[id] = true;\n        var scale = null;\n\n        if (id in scales && scales[id].type === scaleType) {\n          scale = scales[id];\n          scale.options = scaleOptions;\n          scale.ctx = me.ctx;\n          scale.chart = me;\n        } else {\n          var scaleClass = Chart.scaleService.getScaleConstructor(scaleType);\n\n          if (!scaleClass) {\n            return;\n          }\n\n          scale = new scaleClass({\n            id: id,\n            type: scaleType,\n            options: scaleOptions,\n            ctx: me.ctx,\n            chart: me\n          });\n          scales[scale.id] = scale;\n        }\n\n        scale.mergeTicksOptions(); // TODO(SB): I think we should be able to remove this custom case (options.scale)\n        // and consider it as a regular scale part of the \"scales\"\" map only! This would\n        // make the logic easier and remove some useless? custom code.\n\n        if (item.isDefault) {\n          me.scale = scale;\n        }\n      }); // clear up discarded scales\n\n      helpers.each(updated, function (hasUpdated, id) {\n        if (!hasUpdated) {\n          delete scales[id];\n        }\n      });\n      me.scales = scales;\n      Chart.scaleService.addScalesToLayout(this);\n    },\n    buildOrUpdateControllers: function buildOrUpdateControllers() {\n      var me = this;\n      var types = [];\n      var newControllers = [];\n      helpers.each(me.data.datasets, function (dataset, datasetIndex) {\n        var meta = me.getDatasetMeta(datasetIndex);\n        var type = dataset.type || me.config.type;\n\n        if (meta.type && meta.type !== type) {\n          me.destroyDatasetMeta(datasetIndex);\n          meta = me.getDatasetMeta(datasetIndex);\n        }\n\n        meta.type = type;\n        types.push(meta.type);\n\n        if (meta.controller) {\n          meta.controller.updateIndex(datasetIndex);\n          meta.controller.linkScales();\n        } else {\n          var ControllerClass = Chart.controllers[meta.type];\n\n          if (ControllerClass === undefined) {\n            throw new Error('\"' + meta.type + '\" is not a chart type.');\n          }\n\n          meta.controller = new ControllerClass(me, datasetIndex);\n          newControllers.push(meta.controller);\n        }\n      }, me);\n      return newControllers;\n    },\n\n    /**\n     * Reset the elements of all datasets\n     * @private\n     */\n    resetElements: function resetElements() {\n      var me = this;\n      helpers.each(me.data.datasets, function (dataset, datasetIndex) {\n        me.getDatasetMeta(datasetIndex).controller.reset();\n      }, me);\n    },\n\n    /**\n    * Resets the chart back to it's state before the initial animation\n    */\n    reset: function reset() {\n      this.resetElements();\n      this.tooltip.initialize();\n    },\n    update: function update(config) {\n      var me = this;\n\n      if (!config || typeof config !== 'object') {\n        // backwards compatibility\n        config = {\n          duration: config,\n          lazy: arguments[1]\n        };\n      }\n\n      updateConfig(me); // plugins options references might have change, let's invalidate the cache\n      // https://github.com/chartjs/Chart.js/issues/5111#issuecomment-355934167\n\n      plugins._invalidate(me);\n\n      if (plugins.notify(me, 'beforeUpdate') === false) {\n        return;\n      } // In case the entire data object changed\n\n\n      me.tooltip._data = me.data; // Make sure dataset controllers are updated and new controllers are reset\n\n      var newControllers = me.buildOrUpdateControllers(); // Make sure all dataset controllers have correct meta data counts\n\n      helpers.each(me.data.datasets, function (dataset, datasetIndex) {\n        me.getDatasetMeta(datasetIndex).controller.buildOrUpdateElements();\n      }, me);\n      me.updateLayout(); // Can only reset the new controllers after the scales have been updated\n\n      if (me.options.animation && me.options.animation.duration) {\n        helpers.each(newControllers, function (controller) {\n          controller.reset();\n        });\n      }\n\n      me.updateDatasets(); // Need to reset tooltip in case it is displayed with elements that are removed\n      // after update.\n\n      me.tooltip.initialize(); // Last active contains items that were previously in the tooltip.\n      // When we reset the tooltip, we need to clear it\n\n      me.lastActive = []; // Do this before render so that any plugins that need final scale updates can use it\n\n      plugins.notify(me, 'afterUpdate');\n\n      if (me._bufferedRender) {\n        me._bufferedRequest = {\n          duration: config.duration,\n          easing: config.easing,\n          lazy: config.lazy\n        };\n      } else {\n        me.render(config);\n      }\n    },\n\n    /**\n     * Updates the chart layout unless a plugin returns `false` to the `beforeLayout`\n     * hook, in which case, plugins will not be called on `afterLayout`.\n     * @private\n     */\n    updateLayout: function updateLayout() {\n      var me = this;\n\n      if (plugins.notify(me, 'beforeLayout') === false) {\n        return;\n      }\n\n      layouts.update(this, this.width, this.height);\n      /**\n       * Provided for backward compatibility, use `afterLayout` instead.\n       * @method IPlugin#afterScaleUpdate\n       * @deprecated since version 2.5.0\n       * @todo remove at version 3\n       * @private\n       */\n\n      plugins.notify(me, 'afterScaleUpdate');\n      plugins.notify(me, 'afterLayout');\n    },\n\n    /**\n     * Updates all datasets unless a plugin returns `false` to the `beforeDatasetsUpdate`\n     * hook, in which case, plugins will not be called on `afterDatasetsUpdate`.\n     * @private\n     */\n    updateDatasets: function updateDatasets() {\n      var me = this;\n\n      if (plugins.notify(me, 'beforeDatasetsUpdate') === false) {\n        return;\n      }\n\n      for (var i = 0, ilen = me.data.datasets.length; i < ilen; ++i) {\n        me.updateDataset(i);\n      }\n\n      plugins.notify(me, 'afterDatasetsUpdate');\n    },\n\n    /**\n     * Updates dataset at index unless a plugin returns `false` to the `beforeDatasetUpdate`\n     * hook, in which case, plugins will not be called on `afterDatasetUpdate`.\n     * @private\n     */\n    updateDataset: function updateDataset(index) {\n      var me = this;\n      var meta = me.getDatasetMeta(index);\n      var args = {\n        meta: meta,\n        index: index\n      };\n\n      if (plugins.notify(me, 'beforeDatasetUpdate', [args]) === false) {\n        return;\n      }\n\n      meta.controller.update();\n      plugins.notify(me, 'afterDatasetUpdate', [args]);\n    },\n    render: function render(config) {\n      var me = this;\n\n      if (!config || typeof config !== 'object') {\n        // backwards compatibility\n        config = {\n          duration: config,\n          lazy: arguments[1]\n        };\n      }\n\n      var duration = config.duration;\n      var lazy = config.lazy;\n\n      if (plugins.notify(me, 'beforeRender') === false) {\n        return;\n      }\n\n      var animationOptions = me.options.animation;\n\n      var onComplete = function onComplete(animation) {\n        plugins.notify(me, 'afterRender');\n        helpers.callback(animationOptions && animationOptions.onComplete, [animation], me);\n      };\n\n      if (animationOptions && (typeof duration !== 'undefined' && duration !== 0 || typeof duration === 'undefined' && animationOptions.duration !== 0)) {\n        var animation = new Chart.Animation({\n          numSteps: (duration || animationOptions.duration) / 16.66,\n          // 60 fps\n          easing: config.easing || animationOptions.easing,\n          render: function render(chart, animationObject) {\n            var easingFunction = helpers.easing.effects[animationObject.easing];\n            var currentStep = animationObject.currentStep;\n            var stepDecimal = currentStep / animationObject.numSteps;\n            chart.draw(easingFunction(stepDecimal), stepDecimal, currentStep);\n          },\n          onAnimationProgress: animationOptions.onProgress,\n          onAnimationComplete: onComplete\n        });\n        Chart.animationService.addAnimation(me, animation, duration, lazy);\n      } else {\n        me.draw(); // See https://github.com/chartjs/Chart.js/issues/3781\n\n        onComplete(new Chart.Animation({\n          numSteps: 0,\n          chart: me\n        }));\n      }\n\n      return me;\n    },\n    draw: function draw(easingValue) {\n      var me = this;\n      me.clear();\n\n      if (helpers.isNullOrUndef(easingValue)) {\n        easingValue = 1;\n      }\n\n      me.transition(easingValue);\n\n      if (plugins.notify(me, 'beforeDraw', [easingValue]) === false) {\n        return;\n      } // Draw all the scales\n\n\n      helpers.each(me.boxes, function (box) {\n        box.draw(me.chartArea);\n      }, me);\n\n      if (me.scale) {\n        me.scale.draw();\n      }\n\n      me.drawDatasets(easingValue);\n\n      me._drawTooltip(easingValue);\n\n      plugins.notify(me, 'afterDraw', [easingValue]);\n    },\n\n    /**\n     * @private\n     */\n    transition: function transition(easingValue) {\n      var me = this;\n\n      for (var i = 0, ilen = (me.data.datasets || []).length; i < ilen; ++i) {\n        if (me.isDatasetVisible(i)) {\n          me.getDatasetMeta(i).controller.transition(easingValue);\n        }\n      }\n\n      me.tooltip.transition(easingValue);\n    },\n\n    /**\n     * Draws all datasets unless a plugin returns `false` to the `beforeDatasetsDraw`\n     * hook, in which case, plugins will not be called on `afterDatasetsDraw`.\n     * @private\n     */\n    drawDatasets: function drawDatasets(easingValue) {\n      var me = this;\n\n      if (plugins.notify(me, 'beforeDatasetsDraw', [easingValue]) === false) {\n        return;\n      } // Draw datasets reversed to support proper line stacking\n\n\n      for (var i = (me.data.datasets || []).length - 1; i >= 0; --i) {\n        if (me.isDatasetVisible(i)) {\n          me.drawDataset(i, easingValue);\n        }\n      }\n\n      plugins.notify(me, 'afterDatasetsDraw', [easingValue]);\n    },\n\n    /**\n     * Draws dataset at index unless a plugin returns `false` to the `beforeDatasetDraw`\n     * hook, in which case, plugins will not be called on `afterDatasetDraw`.\n     * @private\n     */\n    drawDataset: function drawDataset(index, easingValue) {\n      var me = this;\n      var meta = me.getDatasetMeta(index);\n      var args = {\n        meta: meta,\n        index: index,\n        easingValue: easingValue\n      };\n\n      if (plugins.notify(me, 'beforeDatasetDraw', [args]) === false) {\n        return;\n      }\n\n      meta.controller.draw(easingValue);\n      plugins.notify(me, 'afterDatasetDraw', [args]);\n    },\n\n    /**\n     * Draws tooltip unless a plugin returns `false` to the `beforeTooltipDraw`\n     * hook, in which case, plugins will not be called on `afterTooltipDraw`.\n     * @private\n     */\n    _drawTooltip: function _drawTooltip(easingValue) {\n      var me = this;\n      var tooltip = me.tooltip;\n      var args = {\n        tooltip: tooltip,\n        easingValue: easingValue\n      };\n\n      if (plugins.notify(me, 'beforeTooltipDraw', [args]) === false) {\n        return;\n      }\n\n      tooltip.draw();\n      plugins.notify(me, 'afterTooltipDraw', [args]);\n    },\n    // Get the single element that was clicked on\n    // @return : An object containing the dataset index and element index of the matching element. Also contains the rectangle that was draw\n    getElementAtEvent: function getElementAtEvent(e) {\n      return Interaction.modes.single(this, e);\n    },\n    getElementsAtEvent: function getElementsAtEvent(e) {\n      return Interaction.modes.label(this, e, {\n        intersect: true\n      });\n    },\n    getElementsAtXAxis: function getElementsAtXAxis(e) {\n      return Interaction.modes['x-axis'](this, e, {\n        intersect: true\n      });\n    },\n    getElementsAtEventForMode: function getElementsAtEventForMode(e, mode, options) {\n      var method = Interaction.modes[mode];\n\n      if (typeof method === 'function') {\n        return method(this, e, options);\n      }\n\n      return [];\n    },\n    getDatasetAtEvent: function getDatasetAtEvent(e) {\n      return Interaction.modes.dataset(this, e, {\n        intersect: true\n      });\n    },\n    getDatasetMeta: function getDatasetMeta(datasetIndex) {\n      var me = this;\n      var dataset = me.data.datasets[datasetIndex];\n\n      if (!dataset._meta) {\n        dataset._meta = {};\n      }\n\n      var meta = dataset._meta[me.id];\n\n      if (!meta) {\n        meta = dataset._meta[me.id] = {\n          type: null,\n          data: [],\n          dataset: null,\n          controller: null,\n          hidden: null,\n          // See isDatasetVisible() comment\n          xAxisID: null,\n          yAxisID: null\n        };\n      }\n\n      return meta;\n    },\n    getVisibleDatasetCount: function getVisibleDatasetCount() {\n      var count = 0;\n\n      for (var i = 0, ilen = this.data.datasets.length; i < ilen; ++i) {\n        if (this.isDatasetVisible(i)) {\n          count++;\n        }\n      }\n\n      return count;\n    },\n    isDatasetVisible: function isDatasetVisible(datasetIndex) {\n      var meta = this.getDatasetMeta(datasetIndex); // meta.hidden is a per chart dataset hidden flag override with 3 states: if true or false,\n      // the dataset.hidden value is ignored, else if null, the dataset hidden state is returned.\n\n      return typeof meta.hidden === 'boolean' ? !meta.hidden : !this.data.datasets[datasetIndex].hidden;\n    },\n    generateLegend: function generateLegend() {\n      return this.options.legendCallback(this);\n    },\n\n    /**\n     * @private\n     */\n    destroyDatasetMeta: function destroyDatasetMeta(datasetIndex) {\n      var id = this.id;\n      var dataset = this.data.datasets[datasetIndex];\n      var meta = dataset._meta && dataset._meta[id];\n\n      if (meta) {\n        meta.controller.destroy();\n        delete dataset._meta[id];\n      }\n    },\n    destroy: function destroy() {\n      var me = this;\n      var canvas = me.canvas;\n      var i, ilen;\n      me.stop(); // dataset controllers need to cleanup associated data\n\n      for (i = 0, ilen = me.data.datasets.length; i < ilen; ++i) {\n        me.destroyDatasetMeta(i);\n      }\n\n      if (canvas) {\n        me.unbindEvents();\n        helpers.canvas.clear(me);\n        platform.releaseContext(me.ctx);\n        me.canvas = null;\n        me.ctx = null;\n      }\n\n      plugins.notify(me, 'destroy');\n      delete Chart.instances[me.id];\n    },\n    toBase64Image: function toBase64Image() {\n      return this.canvas.toDataURL.apply(this.canvas, arguments);\n    },\n    initToolTip: function initToolTip() {\n      var me = this;\n      me.tooltip = new Chart.Tooltip({\n        _chart: me,\n        _chartInstance: me,\n        // deprecated, backward compatibility\n        _data: me.data,\n        _options: me.options.tooltips\n      }, me);\n    },\n\n    /**\n     * @private\n     */\n    bindEvents: function bindEvents() {\n      var me = this;\n      var listeners = me._listeners = {};\n\n      var listener = function listener() {\n        me.eventHandler.apply(me, arguments);\n      };\n\n      helpers.each(me.options.events, function (type) {\n        platform.addEventListener(me, type, listener);\n        listeners[type] = listener;\n      }); // Elements used to detect size change should not be injected for non responsive charts.\n      // See https://github.com/chartjs/Chart.js/issues/2210\n\n      if (me.options.responsive) {\n        listener = function listener() {\n          me.resize();\n        };\n\n        platform.addEventListener(me, 'resize', listener);\n        listeners.resize = listener;\n      }\n    },\n\n    /**\n     * @private\n     */\n    unbindEvents: function unbindEvents() {\n      var me = this;\n      var listeners = me._listeners;\n\n      if (!listeners) {\n        return;\n      }\n\n      delete me._listeners;\n      helpers.each(listeners, function (listener, type) {\n        platform.removeEventListener(me, type, listener);\n      });\n    },\n    updateHoverStyle: function updateHoverStyle(elements, mode, enabled) {\n      var method = enabled ? 'setHoverStyle' : 'removeHoverStyle';\n      var element, i, ilen;\n\n      for (i = 0, ilen = elements.length; i < ilen; ++i) {\n        element = elements[i];\n\n        if (element) {\n          this.getDatasetMeta(element._datasetIndex).controller[method](element);\n        }\n      }\n    },\n\n    /**\n     * @private\n     */\n    eventHandler: function eventHandler(e) {\n      var me = this;\n      var tooltip = me.tooltip;\n\n      if (plugins.notify(me, 'beforeEvent', [e]) === false) {\n        return;\n      } // Buffer any update calls so that renders do not occur\n\n\n      me._bufferedRender = true;\n      me._bufferedRequest = null;\n      var changed = me.handleEvent(e); // for smooth tooltip animations issue #4989\n      // the tooltip should be the source of change\n      // Animation check workaround:\n      // tooltip._start will be null when tooltip isn't animating\n\n      if (tooltip) {\n        changed = tooltip._start ? tooltip.handleEvent(e) : changed | tooltip.handleEvent(e);\n      }\n\n      plugins.notify(me, 'afterEvent', [e]);\n      var bufferedRequest = me._bufferedRequest;\n\n      if (bufferedRequest) {\n        // If we have an update that was triggered, we need to do a normal render\n        me.render(bufferedRequest);\n      } else if (changed && !me.animating) {\n        // If entering, leaving, or changing elements, animate the change via pivot\n        me.stop(); // We only need to render at this point. Updating will cause scales to be\n        // recomputed generating flicker & using more memory than necessary.\n\n        me.render(me.options.hover.animationDuration, true);\n      }\n\n      me._bufferedRender = false;\n      me._bufferedRequest = null;\n      return me;\n    },\n\n    /**\n     * Handle an event\n     * @private\n     * @param {IEvent} event the event to handle\n     * @return {Boolean} true if the chart needs to re-render\n     */\n    handleEvent: function handleEvent(e) {\n      var me = this;\n      var options = me.options || {};\n      var hoverOptions = options.hover;\n      var changed = false;\n      me.lastActive = me.lastActive || []; // Find Active Elements for hover and tooltips\n\n      if (e.type === 'mouseout') {\n        me.active = [];\n      } else {\n        me.active = me.getElementsAtEventForMode(e, hoverOptions.mode, hoverOptions);\n      } // Invoke onHover hook\n      // Need to call with native event here to not break backwards compatibility\n\n\n      helpers.callback(options.onHover || options.hover.onHover, [e.native, me.active], me);\n\n      if (e.type === 'mouseup' || e.type === 'click') {\n        if (options.onClick) {\n          // Use e.native here for backwards compatibility\n          options.onClick.call(me, e.native, me.active);\n        }\n      } // Remove styling for last active (even if it may still be active)\n\n\n      if (me.lastActive.length) {\n        me.updateHoverStyle(me.lastActive, hoverOptions.mode, false);\n      } // Built in hover styling\n\n\n      if (me.active.length && hoverOptions.mode) {\n        me.updateHoverStyle(me.active, hoverOptions.mode, true);\n      }\n\n      changed = !helpers.arrayEquals(me.active, me.lastActive); // Remember Last Actives\n\n      me.lastActive = me.active;\n      return changed;\n    }\n  });\n  /**\n   * Provided for backward compatibility, use Chart instead.\n   * @class Chart.Controller\n   * @deprecated since version 2.6.0\n   * @todo remove at version 3\n   * @private\n   */\n\n  Chart.Controller = Chart;\n};","map":{"version":3,"sources":["/home/mohamed/projects/sap/react-reduction/node_modules/chart.js/src/core/core.controller.js"],"names":["defaults","require","helpers","Interaction","layouts","platform","plugins","module","exports","Chart","types","instances","controllers","initConfig","config","data","datasets","labels","options","configMerge","global","type","updateConfig","chart","newOptions","each","scales","scale","removeBox","ensureScalesHaveIDs","buildOrUpdateScales","tooltip","_options","tooltips","initialize","positionIsHorizontal","position","extend","prototype","construct","item","me","context","acquireContext","canvas","height","width","id","uid","ctx","aspectRatio","_bufferedRender","controller","Object","defineProperty","get","set","value","console","error","update","notify","retinaScale","devicePixelRatio","bindEvents","responsive","resize","initToolTip","clear","stop","animationService","cancelAnimation","silent","maintainAspectRatio","newWidth","Math","max","floor","getMaximumWidth","newHeight","getMaximumHeight","style","newSize","onResize","responsiveAnimationDuration","scalesOptions","scaleOptions","xAxes","xAxisOptions","index","yAxes","yAxisOptions","items","updated","keys","reduce","obj","concat","map","dtype","dposition","push","isDefault","scaleType","valueOrDefault","scaleClass","scaleService","getScaleConstructor","mergeTicksOptions","hasUpdated","addScalesToLayout","buildOrUpdateControllers","newControllers","dataset","datasetIndex","meta","getDatasetMeta","destroyDatasetMeta","updateIndex","linkScales","ControllerClass","undefined","Error","resetElements","reset","duration","lazy","arguments","_invalidate","_data","buildOrUpdateElements","updateLayout","animation","updateDatasets","lastActive","_bufferedRequest","easing","render","i","ilen","length","updateDataset","args","animationOptions","onComplete","callback","Animation","numSteps","animationObject","easingFunction","effects","currentStep","stepDecimal","draw","onAnimationProgress","onProgress","onAnimationComplete","addAnimation","easingValue","isNullOrUndef","transition","boxes","box","chartArea","drawDatasets","_drawTooltip","isDatasetVisible","drawDataset","getElementAtEvent","e","modes","single","getElementsAtEvent","label","intersect","getElementsAtXAxis","getElementsAtEventForMode","mode","method","getDatasetAtEvent","_meta","hidden","xAxisID","yAxisID","getVisibleDatasetCount","count","generateLegend","legendCallback","destroy","unbindEvents","releaseContext","toBase64Image","toDataURL","apply","Tooltip","_chart","_chartInstance","listeners","_listeners","listener","eventHandler","events","addEventListener","removeEventListener","updateHoverStyle","elements","enabled","element","_datasetIndex","changed","handleEvent","_start","bufferedRequest","animating","hover","animationDuration","hoverOptions","active","onHover","native","onClick","call","arrayEquals","Controller"],"mappings":"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","sourcesContent":["'use strict';\n\nvar defaults = require('./core.defaults');\nvar helpers = require('../helpers/index');\nvar Interaction = require('./core.interaction');\nvar layouts = require('./core.layouts');\nvar platform = require('../platforms/platform');\nvar plugins = require('./core.plugins');\n\nmodule.exports = function(Chart) {\n\n\t// Create a dictionary of chart types, to allow for extension of existing types\n\tChart.types = {};\n\n\t// Store a reference to each instance - allowing us to globally resize chart instances on window resize.\n\t// Destroy method on the chart will remove the instance of the chart from this reference.\n\tChart.instances = {};\n\n\t// Controllers available for dataset visualization eg. bar, line, slice, etc.\n\tChart.controllers = {};\n\n\t/**\n\t * Initializes the given config with global and chart default values.\n\t */\n\tfunction initConfig(config) {\n\t\tconfig = config || {};\n\n\t\t// Do NOT use configMerge() for the data object because this method merges arrays\n\t\t// and so would change references to labels and datasets, preventing data updates.\n\t\tvar data = config.data = config.data || {};\n\t\tdata.datasets = data.datasets || [];\n\t\tdata.labels = data.labels || [];\n\n\t\tconfig.options = helpers.configMerge(\n\t\t\tdefaults.global,\n\t\t\tdefaults[config.type],\n\t\t\tconfig.options || {});\n\n\t\treturn config;\n\t}\n\n\t/**\n\t * Updates the config of the chart\n\t * @param chart {Chart} chart to update the options for\n\t */\n\tfunction updateConfig(chart) {\n\t\tvar newOptions = chart.options;\n\n\t\thelpers.each(chart.scales, function(scale) {\n\t\t\tlayouts.removeBox(chart, scale);\n\t\t});\n\n\t\tnewOptions = helpers.configMerge(\n\t\t\tChart.defaults.global,\n\t\t\tChart.defaults[chart.config.type],\n\t\t\tnewOptions);\n\n\t\tchart.options = chart.config.options = newOptions;\n\t\tchart.ensureScalesHaveIDs();\n\t\tchart.buildOrUpdateScales();\n\t\t// Tooltip\n\t\tchart.tooltip._options = newOptions.tooltips;\n\t\tchart.tooltip.initialize();\n\t}\n\n\tfunction positionIsHorizontal(position) {\n\t\treturn position === 'top' || position === 'bottom';\n\t}\n\n\thelpers.extend(Chart.prototype, /** @lends Chart */ {\n\t\t/**\n\t\t * @private\n\t\t */\n\t\tconstruct: function(item, config) {\n\t\t\tvar me = this;\n\n\t\t\tconfig = initConfig(config);\n\n\t\t\tvar context = platform.acquireContext(item, config);\n\t\t\tvar canvas = context && context.canvas;\n\t\t\tvar height = canvas && canvas.height;\n\t\t\tvar width = canvas && canvas.width;\n\n\t\t\tme.id = helpers.uid();\n\t\t\tme.ctx = context;\n\t\t\tme.canvas = canvas;\n\t\t\tme.config = config;\n\t\t\tme.width = width;\n\t\t\tme.height = height;\n\t\t\tme.aspectRatio = height ? width / height : null;\n\t\t\tme.options = config.options;\n\t\t\tme._bufferedRender = false;\n\n\t\t\t/**\n\t\t\t * Provided for backward compatibility, Chart and Chart.Controller have been merged,\n\t\t\t * the \"instance\" still need to be defined since it might be called from plugins.\n\t\t\t * @prop Chart#chart\n\t\t\t * @deprecated since version 2.6.0\n\t\t\t * @todo remove at version 3\n\t\t\t * @private\n\t\t\t */\n\t\t\tme.chart = me;\n\t\t\tme.controller = me; // chart.chart.controller #inception\n\n\t\t\t// Add the chart instance to the global namespace\n\t\t\tChart.instances[me.id] = me;\n\n\t\t\t// Define alias to the config data: `chart.data === chart.config.data`\n\t\t\tObject.defineProperty(me, 'data', {\n\t\t\t\tget: function() {\n\t\t\t\t\treturn me.config.data;\n\t\t\t\t},\n\t\t\t\tset: function(value) {\n\t\t\t\t\tme.config.data = value;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (!context || !canvas) {\n\t\t\t\t// The given item is not a compatible context2d element, let's return before finalizing\n\t\t\t\t// the chart initialization but after setting basic chart / controller properties that\n\t\t\t\t// can help to figure out that the chart is not valid (e.g chart.canvas !== null);\n\t\t\t\t// https://github.com/chartjs/Chart.js/issues/2807\n\t\t\t\tconsole.error(\"Failed to create chart: can't acquire context from the given item\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tme.initialize();\n\t\t\tme.update();\n\t\t},\n\n\t\t/**\n\t\t * @private\n\t\t */\n\t\tinitialize: function() {\n\t\t\tvar me = this;\n\n\t\t\t// Before init plugin notification\n\t\t\tplugins.notify(me, 'beforeInit');\n\n\t\t\thelpers.retinaScale(me, me.options.devicePixelRatio);\n\n\t\t\tme.bindEvents();\n\n\t\t\tif (me.options.responsive) {\n\t\t\t\t// Initial resize before chart draws (must be silent to preserve initial animations).\n\t\t\t\tme.resize(true);\n\t\t\t}\n\n\t\t\t// Make sure scales have IDs and are built before we build any controllers.\n\t\t\tme.ensureScalesHaveIDs();\n\t\t\tme.buildOrUpdateScales();\n\t\t\tme.initToolTip();\n\n\t\t\t// After init plugin notification\n\t\t\tplugins.notify(me, 'afterInit');\n\n\t\t\treturn me;\n\t\t},\n\n\t\tclear: function() {\n\t\t\thelpers.canvas.clear(this);\n\t\t\treturn this;\n\t\t},\n\n\t\tstop: function() {\n\t\t\t// Stops any current animation loop occurring\n\t\t\tChart.animationService.cancelAnimation(this);\n\t\t\treturn this;\n\t\t},\n\n\t\tresize: function(silent) {\n\t\t\tvar me = this;\n\t\t\tvar options = me.options;\n\t\t\tvar canvas = me.canvas;\n\t\t\tvar aspectRatio = (options.maintainAspectRatio && me.aspectRatio) || null;\n\n\t\t\t// the canvas render width and height will be casted to integers so make sure that\n\t\t\t// the canvas display style uses the same integer values to avoid blurring effect.\n\n\t\t\t// Set to 0 instead of canvas.size because the size defaults to 300x150 if the element is collased\n\t\t\tvar newWidth = Math.max(0, Math.floor(helpers.getMaximumWidth(canvas)));\n\t\t\tvar newHeight = Math.max(0, Math.floor(aspectRatio ? newWidth / aspectRatio : helpers.getMaximumHeight(canvas)));\n\n\t\t\tif (me.width === newWidth && me.height === newHeight) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcanvas.width = me.width = newWidth;\n\t\t\tcanvas.height = me.height = newHeight;\n\t\t\tcanvas.style.width = newWidth + 'px';\n\t\t\tcanvas.style.height = newHeight + 'px';\n\n\t\t\thelpers.retinaScale(me, options.devicePixelRatio);\n\n\t\t\tif (!silent) {\n\t\t\t\t// Notify any plugins about the resize\n\t\t\t\tvar newSize = {width: newWidth, height: newHeight};\n\t\t\t\tplugins.notify(me, 'resize', [newSize]);\n\n\t\t\t\t// Notify of resize\n\t\t\t\tif (me.options.onResize) {\n\t\t\t\t\tme.options.onResize(me, newSize);\n\t\t\t\t}\n\n\t\t\t\tme.stop();\n\t\t\t\tme.update(me.options.responsiveAnimationDuration);\n\t\t\t}\n\t\t},\n\n\t\tensureScalesHaveIDs: function() {\n\t\t\tvar options = this.options;\n\t\t\tvar scalesOptions = options.scales || {};\n\t\t\tvar scaleOptions = options.scale;\n\n\t\t\thelpers.each(scalesOptions.xAxes, function(xAxisOptions, index) {\n\t\t\t\txAxisOptions.id = xAxisOptions.id || ('x-axis-' + index);\n\t\t\t});\n\n\t\t\thelpers.each(scalesOptions.yAxes, function(yAxisOptions, index) {\n\t\t\t\tyAxisOptions.id = yAxisOptions.id || ('y-axis-' + index);\n\t\t\t});\n\n\t\t\tif (scaleOptions) {\n\t\t\t\tscaleOptions.id = scaleOptions.id || 'scale';\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Builds a map of scale ID to scale object for future lookup.\n\t\t */\n\t\tbuildOrUpdateScales: function() {\n\t\t\tvar me = this;\n\t\t\tvar options = me.options;\n\t\t\tvar scales = me.scales || {};\n\t\t\tvar items = [];\n\t\t\tvar updated = Object.keys(scales).reduce(function(obj, id) {\n\t\t\t\tobj[id] = false;\n\t\t\t\treturn obj;\n\t\t\t}, {});\n\n\t\t\tif (options.scales) {\n\t\t\t\titems = items.concat(\n\t\t\t\t\t(options.scales.xAxes || []).map(function(xAxisOptions) {\n\t\t\t\t\t\treturn {options: xAxisOptions, dtype: 'category', dposition: 'bottom'};\n\t\t\t\t\t}),\n\t\t\t\t\t(options.scales.yAxes || []).map(function(yAxisOptions) {\n\t\t\t\t\t\treturn {options: yAxisOptions, dtype: 'linear', dposition: 'left'};\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (options.scale) {\n\t\t\t\titems.push({\n\t\t\t\t\toptions: options.scale,\n\t\t\t\t\tdtype: 'radialLinear',\n\t\t\t\t\tisDefault: true,\n\t\t\t\t\tdposition: 'chartArea'\n\t\t\t\t});\n\t\t\t}\n\n\t\t\thelpers.each(items, function(item) {\n\t\t\t\tvar scaleOptions = item.options;\n\t\t\t\tvar id = scaleOptions.id;\n\t\t\t\tvar scaleType = helpers.valueOrDefault(scaleOptions.type, item.dtype);\n\n\t\t\t\tif (positionIsHorizontal(scaleOptions.position) !== positionIsHorizontal(item.dposition)) {\n\t\t\t\t\tscaleOptions.position = item.dposition;\n\t\t\t\t}\n\n\t\t\t\tupdated[id] = true;\n\t\t\t\tvar scale = null;\n\t\t\t\tif (id in scales && scales[id].type === scaleType) {\n\t\t\t\t\tscale = scales[id];\n\t\t\t\t\tscale.options = scaleOptions;\n\t\t\t\t\tscale.ctx = me.ctx;\n\t\t\t\t\tscale.chart = me;\n\t\t\t\t} else {\n\t\t\t\t\tvar scaleClass = Chart.scaleService.getScaleConstructor(scaleType);\n\t\t\t\t\tif (!scaleClass) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tscale = new scaleClass({\n\t\t\t\t\t\tid: id,\n\t\t\t\t\t\ttype: scaleType,\n\t\t\t\t\t\toptions: scaleOptions,\n\t\t\t\t\t\tctx: me.ctx,\n\t\t\t\t\t\tchart: me\n\t\t\t\t\t});\n\t\t\t\t\tscales[scale.id] = scale;\n\t\t\t\t}\n\n\t\t\t\tscale.mergeTicksOptions();\n\n\t\t\t\t// TODO(SB): I think we should be able to remove this custom case (options.scale)\n\t\t\t\t// and consider it as a regular scale part of the \"scales\"\" map only! This would\n\t\t\t\t// make the logic easier and remove some useless? custom code.\n\t\t\t\tif (item.isDefault) {\n\t\t\t\t\tme.scale = scale;\n\t\t\t\t}\n\t\t\t});\n\t\t\t// clear up discarded scales\n\t\t\thelpers.each(updated, function(hasUpdated, id) {\n\t\t\t\tif (!hasUpdated) {\n\t\t\t\t\tdelete scales[id];\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tme.scales = scales;\n\n\t\t\tChart.scaleService.addScalesToLayout(this);\n\t\t},\n\n\t\tbuildOrUpdateControllers: function() {\n\t\t\tvar me = this;\n\t\t\tvar types = [];\n\t\t\tvar newControllers = [];\n\n\t\t\thelpers.each(me.data.datasets, function(dataset, datasetIndex) {\n\t\t\t\tvar meta = me.getDatasetMeta(datasetIndex);\n\t\t\t\tvar type = dataset.type || me.config.type;\n\n\t\t\t\tif (meta.type && meta.type !== type) {\n\t\t\t\t\tme.destroyDatasetMeta(datasetIndex);\n\t\t\t\t\tmeta = me.getDatasetMeta(datasetIndex);\n\t\t\t\t}\n\t\t\t\tmeta.type = type;\n\n\t\t\t\ttypes.push(meta.type);\n\n\t\t\t\tif (meta.controller) {\n\t\t\t\t\tmeta.controller.updateIndex(datasetIndex);\n\t\t\t\t\tmeta.controller.linkScales();\n\t\t\t\t} else {\n\t\t\t\t\tvar ControllerClass = Chart.controllers[meta.type];\n\t\t\t\t\tif (ControllerClass === undefined) {\n\t\t\t\t\t\tthrow new Error('\"' + meta.type + '\" is not a chart type.');\n\t\t\t\t\t}\n\n\t\t\t\t\tmeta.controller = new ControllerClass(me, datasetIndex);\n\t\t\t\t\tnewControllers.push(meta.controller);\n\t\t\t\t}\n\t\t\t}, me);\n\n\t\t\treturn newControllers;\n\t\t},\n\n\t\t/**\n\t\t * Reset the elements of all datasets\n\t\t * @private\n\t\t */\n\t\tresetElements: function() {\n\t\t\tvar me = this;\n\t\t\thelpers.each(me.data.datasets, function(dataset, datasetIndex) {\n\t\t\t\tme.getDatasetMeta(datasetIndex).controller.reset();\n\t\t\t}, me);\n\t\t},\n\n\t\t/**\n\t\t* Resets the chart back to it's state before the initial animation\n\t\t*/\n\t\treset: function() {\n\t\t\tthis.resetElements();\n\t\t\tthis.tooltip.initialize();\n\t\t},\n\n\t\tupdate: function(config) {\n\t\t\tvar me = this;\n\n\t\t\tif (!config || typeof config !== 'object') {\n\t\t\t\t// backwards compatibility\n\t\t\t\tconfig = {\n\t\t\t\t\tduration: config,\n\t\t\t\t\tlazy: arguments[1]\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tupdateConfig(me);\n\n\t\t\t// plugins options references might have change, let's invalidate the cache\n\t\t\t// https://github.com/chartjs/Chart.js/issues/5111#issuecomment-355934167\n\t\t\tplugins._invalidate(me);\n\n\t\t\tif (plugins.notify(me, 'beforeUpdate') === false) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// In case the entire data object changed\n\t\t\tme.tooltip._data = me.data;\n\n\t\t\t// Make sure dataset controllers are updated and new controllers are reset\n\t\t\tvar newControllers = me.buildOrUpdateControllers();\n\n\t\t\t// Make sure all dataset controllers have correct meta data counts\n\t\t\thelpers.each(me.data.datasets, function(dataset, datasetIndex) {\n\t\t\t\tme.getDatasetMeta(datasetIndex).controller.buildOrUpdateElements();\n\t\t\t}, me);\n\n\t\t\tme.updateLayout();\n\n\t\t\t// Can only reset the new controllers after the scales have been updated\n\t\t\tif (me.options.animation && me.options.animation.duration) {\n\t\t\t\thelpers.each(newControllers, function(controller) {\n\t\t\t\t\tcontroller.reset();\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tme.updateDatasets();\n\n\t\t\t// Need to reset tooltip in case it is displayed with elements that are removed\n\t\t\t// after update.\n\t\t\tme.tooltip.initialize();\n\n\t\t\t// Last active contains items that were previously in the tooltip.\n\t\t\t// When we reset the tooltip, we need to clear it\n\t\t\tme.lastActive = [];\n\n\t\t\t// Do this before render so that any plugins that need final scale updates can use it\n\t\t\tplugins.notify(me, 'afterUpdate');\n\n\t\t\tif (me._bufferedRender) {\n\t\t\t\tme._bufferedRequest = {\n\t\t\t\t\tduration: config.duration,\n\t\t\t\t\teasing: config.easing,\n\t\t\t\t\tlazy: config.lazy\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tme.render(config);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Updates the chart layout unless a plugin returns `false` to the `beforeLayout`\n\t\t * hook, in which case, plugins will not be called on `afterLayout`.\n\t\t * @private\n\t\t */\n\t\tupdateLayout: function() {\n\t\t\tvar me = this;\n\n\t\t\tif (plugins.notify(me, 'beforeLayout') === false) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlayouts.update(this, this.width, this.height);\n\n\t\t\t/**\n\t\t\t * Provided for backward compatibility, use `afterLayout` instead.\n\t\t\t * @method IPlugin#afterScaleUpdate\n\t\t\t * @deprecated since version 2.5.0\n\t\t\t * @todo remove at version 3\n\t\t\t * @private\n\t\t\t */\n\t\t\tplugins.notify(me, 'afterScaleUpdate');\n\t\t\tplugins.notify(me, 'afterLayout');\n\t\t},\n\n\t\t/**\n\t\t * Updates all datasets unless a plugin returns `false` to the `beforeDatasetsUpdate`\n\t\t * hook, in which case, plugins will not be called on `afterDatasetsUpdate`.\n\t\t * @private\n\t\t */\n\t\tupdateDatasets: function() {\n\t\t\tvar me = this;\n\n\t\t\tif (plugins.notify(me, 'beforeDatasetsUpdate') === false) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfor (var i = 0, ilen = me.data.datasets.length; i < ilen; ++i) {\n\t\t\t\tme.updateDataset(i);\n\t\t\t}\n\n\t\t\tplugins.notify(me, 'afterDatasetsUpdate');\n\t\t},\n\n\t\t/**\n\t\t * Updates dataset at index unless a plugin returns `false` to the `beforeDatasetUpdate`\n\t\t * hook, in which case, plugins will not be called on `afterDatasetUpdate`.\n\t\t * @private\n\t\t */\n\t\tupdateDataset: function(index) {\n\t\t\tvar me = this;\n\t\t\tvar meta = me.getDatasetMeta(index);\n\t\t\tvar args = {\n\t\t\t\tmeta: meta,\n\t\t\t\tindex: index\n\t\t\t};\n\n\t\t\tif (plugins.notify(me, 'beforeDatasetUpdate', [args]) === false) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tmeta.controller.update();\n\n\t\t\tplugins.notify(me, 'afterDatasetUpdate', [args]);\n\t\t},\n\n\t\trender: function(config) {\n\t\t\tvar me = this;\n\n\t\t\tif (!config || typeof config !== 'object') {\n\t\t\t\t// backwards compatibility\n\t\t\t\tconfig = {\n\t\t\t\t\tduration: config,\n\t\t\t\t\tlazy: arguments[1]\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tvar duration = config.duration;\n\t\t\tvar lazy = config.lazy;\n\n\t\t\tif (plugins.notify(me, 'beforeRender') === false) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar animationOptions = me.options.animation;\n\t\t\tvar onComplete = function(animation) {\n\t\t\t\tplugins.notify(me, 'afterRender');\n\t\t\t\thelpers.callback(animationOptions && animationOptions.onComplete, [animation], me);\n\t\t\t};\n\n\t\t\tif (animationOptions && ((typeof duration !== 'undefined' && duration !== 0) || (typeof duration === 'undefined' && animationOptions.duration !== 0))) {\n\t\t\t\tvar animation = new Chart.Animation({\n\t\t\t\t\tnumSteps: (duration || animationOptions.duration) / 16.66, // 60 fps\n\t\t\t\t\teasing: config.easing || animationOptions.easing,\n\n\t\t\t\t\trender: function(chart, animationObject) {\n\t\t\t\t\t\tvar easingFunction = helpers.easing.effects[animationObject.easing];\n\t\t\t\t\t\tvar currentStep = animationObject.currentStep;\n\t\t\t\t\t\tvar stepDecimal = currentStep / animationObject.numSteps;\n\n\t\t\t\t\t\tchart.draw(easingFunction(stepDecimal), stepDecimal, currentStep);\n\t\t\t\t\t},\n\n\t\t\t\t\tonAnimationProgress: animationOptions.onProgress,\n\t\t\t\t\tonAnimationComplete: onComplete\n\t\t\t\t});\n\n\t\t\t\tChart.animationService.addAnimation(me, animation, duration, lazy);\n\t\t\t} else {\n\t\t\t\tme.draw();\n\n\t\t\t\t// See https://github.com/chartjs/Chart.js/issues/3781\n\t\t\t\tonComplete(new Chart.Animation({numSteps: 0, chart: me}));\n\t\t\t}\n\n\t\t\treturn me;\n\t\t},\n\n\t\tdraw: function(easingValue) {\n\t\t\tvar me = this;\n\n\t\t\tme.clear();\n\n\t\t\tif (helpers.isNullOrUndef(easingValue)) {\n\t\t\t\teasingValue = 1;\n\t\t\t}\n\n\t\t\tme.transition(easingValue);\n\n\t\t\tif (plugins.notify(me, 'beforeDraw', [easingValue]) === false) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Draw all the scales\n\t\t\thelpers.each(me.boxes, function(box) {\n\t\t\t\tbox.draw(me.chartArea);\n\t\t\t}, me);\n\n\t\t\tif (me.scale) {\n\t\t\t\tme.scale.draw();\n\t\t\t}\n\n\t\t\tme.drawDatasets(easingValue);\n\t\t\tme._drawTooltip(easingValue);\n\n\t\t\tplugins.notify(me, 'afterDraw', [easingValue]);\n\t\t},\n\n\t\t/**\n\t\t * @private\n\t\t */\n\t\ttransition: function(easingValue) {\n\t\t\tvar me = this;\n\n\t\t\tfor (var i = 0, ilen = (me.data.datasets || []).length; i < ilen; ++i) {\n\t\t\t\tif (me.isDatasetVisible(i)) {\n\t\t\t\t\tme.getDatasetMeta(i).controller.transition(easingValue);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tme.tooltip.transition(easingValue);\n\t\t},\n\n\t\t/**\n\t\t * Draws all datasets unless a plugin returns `false` to the `beforeDatasetsDraw`\n\t\t * hook, in which case, plugins will not be called on `afterDatasetsDraw`.\n\t\t * @private\n\t\t */\n\t\tdrawDatasets: function(easingValue) {\n\t\t\tvar me = this;\n\n\t\t\tif (plugins.notify(me, 'beforeDatasetsDraw', [easingValue]) === false) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Draw datasets reversed to support proper line stacking\n\t\t\tfor (var i = (me.data.datasets || []).length - 1; i >= 0; --i) {\n\t\t\t\tif (me.isDatasetVisible(i)) {\n\t\t\t\t\tme.drawDataset(i, easingValue);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tplugins.notify(me, 'afterDatasetsDraw', [easingValue]);\n\t\t},\n\n\t\t/**\n\t\t * Draws dataset at index unless a plugin returns `false` to the `beforeDatasetDraw`\n\t\t * hook, in which case, plugins will not be called on `afterDatasetDraw`.\n\t\t * @private\n\t\t */\n\t\tdrawDataset: function(index, easingValue) {\n\t\t\tvar me = this;\n\t\t\tvar meta = me.getDatasetMeta(index);\n\t\t\tvar args = {\n\t\t\t\tmeta: meta,\n\t\t\t\tindex: index,\n\t\t\t\teasingValue: easingValue\n\t\t\t};\n\n\t\t\tif (plugins.notify(me, 'beforeDatasetDraw', [args]) === false) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tmeta.controller.draw(easingValue);\n\n\t\t\tplugins.notify(me, 'afterDatasetDraw', [args]);\n\t\t},\n\n\t\t/**\n\t\t * Draws tooltip unless a plugin returns `false` to the `beforeTooltipDraw`\n\t\t * hook, in which case, plugins will not be called on `afterTooltipDraw`.\n\t\t * @private\n\t\t */\n\t\t_drawTooltip: function(easingValue) {\n\t\t\tvar me = this;\n\t\t\tvar tooltip = me.tooltip;\n\t\t\tvar args = {\n\t\t\t\ttooltip: tooltip,\n\t\t\t\teasingValue: easingValue\n\t\t\t};\n\n\t\t\tif (plugins.notify(me, 'beforeTooltipDraw', [args]) === false) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttooltip.draw();\n\n\t\t\tplugins.notify(me, 'afterTooltipDraw', [args]);\n\t\t},\n\n\t\t// Get the single element that was clicked on\n\t\t// @return : An object containing the dataset index and element index of the matching element. Also contains the rectangle that was draw\n\t\tgetElementAtEvent: function(e) {\n\t\t\treturn Interaction.modes.single(this, e);\n\t\t},\n\n\t\tgetElementsAtEvent: function(e) {\n\t\t\treturn Interaction.modes.label(this, e, {intersect: true});\n\t\t},\n\n\t\tgetElementsAtXAxis: function(e) {\n\t\t\treturn Interaction.modes['x-axis'](this, e, {intersect: true});\n\t\t},\n\n\t\tgetElementsAtEventForMode: function(e, mode, options) {\n\t\t\tvar method = Interaction.modes[mode];\n\t\t\tif (typeof method === 'function') {\n\t\t\t\treturn method(this, e, options);\n\t\t\t}\n\n\t\t\treturn [];\n\t\t},\n\n\t\tgetDatasetAtEvent: function(e) {\n\t\t\treturn Interaction.modes.dataset(this, e, {intersect: true});\n\t\t},\n\n\t\tgetDatasetMeta: function(datasetIndex) {\n\t\t\tvar me = this;\n\t\t\tvar dataset = me.data.datasets[datasetIndex];\n\t\t\tif (!dataset._meta) {\n\t\t\t\tdataset._meta = {};\n\t\t\t}\n\n\t\t\tvar meta = dataset._meta[me.id];\n\t\t\tif (!meta) {\n\t\t\t\tmeta = dataset._meta[me.id] = {\n\t\t\t\t\ttype: null,\n\t\t\t\t\tdata: [],\n\t\t\t\t\tdataset: null,\n\t\t\t\t\tcontroller: null,\n\t\t\t\t\thidden: null,\t\t\t// See isDatasetVisible() comment\n\t\t\t\t\txAxisID: null,\n\t\t\t\t\tyAxisID: null\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn meta;\n\t\t},\n\n\t\tgetVisibleDatasetCount: function() {\n\t\t\tvar count = 0;\n\t\t\tfor (var i = 0, ilen = this.data.datasets.length; i < ilen; ++i) {\n\t\t\t\tif (this.isDatasetVisible(i)) {\n\t\t\t\t\tcount++;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn count;\n\t\t},\n\n\t\tisDatasetVisible: function(datasetIndex) {\n\t\t\tvar meta = this.getDatasetMeta(datasetIndex);\n\n\t\t\t// meta.hidden is a per chart dataset hidden flag override with 3 states: if true or false,\n\t\t\t// the dataset.hidden value is ignored, else if null, the dataset hidden state is returned.\n\t\t\treturn typeof meta.hidden === 'boolean' ? !meta.hidden : !this.data.datasets[datasetIndex].hidden;\n\t\t},\n\n\t\tgenerateLegend: function() {\n\t\t\treturn this.options.legendCallback(this);\n\t\t},\n\n\t\t/**\n\t\t * @private\n\t\t */\n\t\tdestroyDatasetMeta: function(datasetIndex) {\n\t\t\tvar id = this.id;\n\t\t\tvar dataset = this.data.datasets[datasetIndex];\n\t\t\tvar meta = dataset._meta && dataset._meta[id];\n\n\t\t\tif (meta) {\n\t\t\t\tmeta.controller.destroy();\n\t\t\t\tdelete dataset._meta[id];\n\t\t\t}\n\t\t},\n\n\t\tdestroy: function() {\n\t\t\tvar me = this;\n\t\t\tvar canvas = me.canvas;\n\t\t\tvar i, ilen;\n\n\t\t\tme.stop();\n\n\t\t\t// dataset controllers need to cleanup associated data\n\t\t\tfor (i = 0, ilen = me.data.datasets.length; i < ilen; ++i) {\n\t\t\t\tme.destroyDatasetMeta(i);\n\t\t\t}\n\n\t\t\tif (canvas) {\n\t\t\t\tme.unbindEvents();\n\t\t\t\thelpers.canvas.clear(me);\n\t\t\t\tplatform.releaseContext(me.ctx);\n\t\t\t\tme.canvas = null;\n\t\t\t\tme.ctx = null;\n\t\t\t}\n\n\t\t\tplugins.notify(me, 'destroy');\n\n\t\t\tdelete Chart.instances[me.id];\n\t\t},\n\n\t\ttoBase64Image: function() {\n\t\t\treturn this.canvas.toDataURL.apply(this.canvas, arguments);\n\t\t},\n\n\t\tinitToolTip: function() {\n\t\t\tvar me = this;\n\t\t\tme.tooltip = new Chart.Tooltip({\n\t\t\t\t_chart: me,\n\t\t\t\t_chartInstance: me, // deprecated, backward compatibility\n\t\t\t\t_data: me.data,\n\t\t\t\t_options: me.options.tooltips\n\t\t\t}, me);\n\t\t},\n\n\t\t/**\n\t\t * @private\n\t\t */\n\t\tbindEvents: function() {\n\t\t\tvar me = this;\n\t\t\tvar listeners = me._listeners = {};\n\t\t\tvar listener = function() {\n\t\t\t\tme.eventHandler.apply(me, arguments);\n\t\t\t};\n\n\t\t\thelpers.each(me.options.events, function(type) {\n\t\t\t\tplatform.addEventListener(me, type, listener);\n\t\t\t\tlisteners[type] = listener;\n\t\t\t});\n\n\t\t\t// Elements used to detect size change should not be injected for non responsive charts.\n\t\t\t// See https://github.com/chartjs/Chart.js/issues/2210\n\t\t\tif (me.options.responsive) {\n\t\t\t\tlistener = function() {\n\t\t\t\t\tme.resize();\n\t\t\t\t};\n\n\t\t\t\tplatform.addEventListener(me, 'resize', listener);\n\t\t\t\tlisteners.resize = listener;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * @private\n\t\t */\n\t\tunbindEvents: function() {\n\t\t\tvar me = this;\n\t\t\tvar listeners = me._listeners;\n\t\t\tif (!listeners) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdelete me._listeners;\n\t\t\thelpers.each(listeners, function(listener, type) {\n\t\t\t\tplatform.removeEventListener(me, type, listener);\n\t\t\t});\n\t\t},\n\n\t\tupdateHoverStyle: function(elements, mode, enabled) {\n\t\t\tvar method = enabled ? 'setHoverStyle' : 'removeHoverStyle';\n\t\t\tvar element, i, ilen;\n\n\t\t\tfor (i = 0, ilen = elements.length; i < ilen; ++i) {\n\t\t\t\telement = elements[i];\n\t\t\t\tif (element) {\n\t\t\t\t\tthis.getDatasetMeta(element._datasetIndex).controller[method](element);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * @private\n\t\t */\n\t\teventHandler: function(e) {\n\t\t\tvar me = this;\n\t\t\tvar tooltip = me.tooltip;\n\n\t\t\tif (plugins.notify(me, 'beforeEvent', [e]) === false) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Buffer any update calls so that renders do not occur\n\t\t\tme._bufferedRender = true;\n\t\t\tme._bufferedRequest = null;\n\n\t\t\tvar changed = me.handleEvent(e);\n\t\t\t// for smooth tooltip animations issue #4989\n\t\t\t// the tooltip should be the source of change\n\t\t\t// Animation check workaround:\n\t\t\t// tooltip._start will be null when tooltip isn't animating\n\t\t\tif (tooltip) {\n\t\t\t\tchanged = tooltip._start\n\t\t\t\t\t? tooltip.handleEvent(e)\n\t\t\t\t\t: changed | tooltip.handleEvent(e);\n\t\t\t}\n\n\t\t\tplugins.notify(me, 'afterEvent', [e]);\n\n\t\t\tvar bufferedRequest = me._bufferedRequest;\n\t\t\tif (bufferedRequest) {\n\t\t\t\t// If we have an update that was triggered, we need to do a normal render\n\t\t\t\tme.render(bufferedRequest);\n\t\t\t} else if (changed && !me.animating) {\n\t\t\t\t// If entering, leaving, or changing elements, animate the change via pivot\n\t\t\t\tme.stop();\n\n\t\t\t\t// We only need to render at this point. Updating will cause scales to be\n\t\t\t\t// recomputed generating flicker & using more memory than necessary.\n\t\t\t\tme.render(me.options.hover.animationDuration, true);\n\t\t\t}\n\n\t\t\tme._bufferedRender = false;\n\t\t\tme._bufferedRequest = null;\n\n\t\t\treturn me;\n\t\t},\n\n\t\t/**\n\t\t * Handle an event\n\t\t * @private\n\t\t * @param {IEvent} event the event to handle\n\t\t * @return {Boolean} true if the chart needs to re-render\n\t\t */\n\t\thandleEvent: function(e) {\n\t\t\tvar me = this;\n\t\t\tvar options = me.options || {};\n\t\t\tvar hoverOptions = options.hover;\n\t\t\tvar changed = false;\n\n\t\t\tme.lastActive = me.lastActive || [];\n\n\t\t\t// Find Active Elements for hover and tooltips\n\t\t\tif (e.type === 'mouseout') {\n\t\t\t\tme.active = [];\n\t\t\t} else {\n\t\t\t\tme.active = me.getElementsAtEventForMode(e, hoverOptions.mode, hoverOptions);\n\t\t\t}\n\n\t\t\t// Invoke onHover hook\n\t\t\t// Need to call with native event here to not break backwards compatibility\n\t\t\thelpers.callback(options.onHover || options.hover.onHover, [e.native, me.active], me);\n\n\t\t\tif (e.type === 'mouseup' || e.type === 'click') {\n\t\t\t\tif (options.onClick) {\n\t\t\t\t\t// Use e.native here for backwards compatibility\n\t\t\t\t\toptions.onClick.call(me, e.native, me.active);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Remove styling for last active (even if it may still be active)\n\t\t\tif (me.lastActive.length) {\n\t\t\t\tme.updateHoverStyle(me.lastActive, hoverOptions.mode, false);\n\t\t\t}\n\n\t\t\t// Built in hover styling\n\t\t\tif (me.active.length && hoverOptions.mode) {\n\t\t\t\tme.updateHoverStyle(me.active, hoverOptions.mode, true);\n\t\t\t}\n\n\t\t\tchanged = !helpers.arrayEquals(me.active, me.lastActive);\n\n\t\t\t// Remember Last Actives\n\t\t\tme.lastActive = me.active;\n\n\t\t\treturn changed;\n\t\t}\n\t});\n\n\t/**\n\t * Provided for backward compatibility, use Chart instead.\n\t * @class Chart.Controller\n\t * @deprecated since version 2.6.0\n\t * @todo remove at version 3\n\t * @private\n\t */\n\tChart.Controller = Chart;\n};\n"]},"metadata":{},"sourceType":"script"}